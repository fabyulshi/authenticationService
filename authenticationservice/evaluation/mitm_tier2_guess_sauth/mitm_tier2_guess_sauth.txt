
runfile('/home/locksmith/phd/thesis/code/AuthenticationService/authenticationservice/evaluation/mitm_tier2_guess_sauth/locathesimulator.py', wdir='/home/locksmith/phd/thesis/code/AuthenticationService/authenticationservice/evaluation/mitm_tier2_guess_sauth')
Reloaded modules: useragentsimulator, locationserviceagentsimulator, locationservice, agentsimulator, jsonhelper, abeauthorityagent, netservice, status, states, netservicetype, useragent, locationserviceutility, constants
Simulation starting...
Registering keys of keyType:  Password Hash (KDF)
Registering keys of keyType:  Shared Key
Registering keys of keyType:  Fingerprint
Registering keys of keyType:  PIN
Registering keys of keyType:  Pattern
Registering keys of keyType:  Face
Registering keys of keyType:  Iris
Location Server: runProtocol.
User agent: runProtocol.
Location Server: processing state:  State.START_IDLE
Location Server: processStartIdle.
Location Server: processStartIdle. Reset instance variables.
User agent: processing state:  State.START_IDLE
User agent: processStartIdle.
location.service.agent : entering BNONCE scheduler...
Location Server: processing state:  State.LISTEN_FOR_CONNECTIONS
User agent: processStartIdle. Reset instance variables.
location.service.agent : BNONCE expired. Generating a new one...
Location Server: processListenForConnections.
self.agentObject =  <locationservice.LocationService object at 0x7f27bc0bb588>
User agent: processing state:  State.CONNECT_TO_SERVICE
User agent: processConnectToService.
User agent: connected to Location Service.
Location Server: connection request received and accepted.
User agent: CONNECTED to Location Service.
Location Server: CONNECTION_REQUEST_ACCEPTED_CONNECTED.
Location Server: processing state:  State.BROADCAST_ECDHE_ADVERTISEMENT_BLUETOOTH_LOCAUTH_ADVERTISEMENT
User agent: processing state:  State.BROADCAST_ECDHE_ADVERTISEMENT_BLUETOOTH_LOCAUTH_ADVERTISEMENT
Location Server: processBroadcastEcdheAdvertisementBluetoothLocauthAdvertisement.
User agent: processBroadcastEcdheAdvertisementBluetoothLocauthAdvertisement.
Location Server: about to send message at processBroadcastEcdheAdvertisementBluetoothLocauthAdvertisement.
User agent: received proper Location Service advertisement. Setting SPIr.
location.service.agent  simulator, send raw message:
User agent: SERVICE_ADVERTISEMENT_DETECTED.
 b'\x00\x00\x00j\x00\x00\x00\x00\x00\x00\x00\x00(Y_(vh\n\x05\x00a\x00\x00\x00\x00\x00\x00{"service": "LOCAUTH Service", "uuid": "10caa7h0-5e12-71ce-010c-a7hebeac0140"}'
User agent: processing state:  State.BROADCAST_ECDHE_RECEIVE_BNONCE
Location Server: finished Bluetooth service advertising.
User agent: processBroadcastEcdheReceiveBnonce.
Location Server: processing state:  State.BROADCAST_ECDHE_BROADCAST_BNONCE
Location Server: Broadcast BNONCE.
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: Broadcast BNONCE: BNONCE empty. Waiting...
Location Server: sending BNONCE...
location.service.agent : the Nb is:  b'cU1bVLQN7aMr7qNgMrrRFA=='
location.service.agent  simulator, send raw message:
 b'\x00\x00\x14\xad\x00\x00\x00\x00\x00\x00\x00\x00(Y_(vh\n\x05\x00b\x00\x00\x00\x00\x00\x01{"bnonce": "{\\"c1\\": {\\"C0\\": {\\"__value__\\": \\"3:L+aOiZjYmJ12mMh3NGJkZFC7XpX5/ohT+bxYNRgjSvd+AfLIs7KQFSWGq+IWKmaOZW6DNX6YgI5NoKxlnB7st4UQ5PsaSEK66UK59qswq/LQpva1HRC4Jch8JOV3NFe1/92KZPxHKwbjtlHfEj1ZpVKCkoVo4rah8R9HRhlAS6M=\\", \\"__class__\\": \\"pairing.Element\\", \\"__pairingCurve__\\": \\"SS512\\"}, \\"C1\\": {\\"MONCALAMARIEXPEDIA.COM.SPENDINGLIMIT.LEVEL2\\": {\\"__value__\\": \\"3:QjC0CEZZJoqME3MWjP84ibcE3raFj8TihaYycDpqgPXPVmdSc5i+sLwlLIEujtJogtlkkf2ik5CoWMk4B0D+2qC4dwv3s7btlw8hrEgU+he6jxiJaH82lkJpMpp5/u1C2fwAP0HjnUsN9zZ9D6KPFOSzR9Cy2s2GKYq/LmZTyDc=\\", \\"__class__\\": \\"pairing.Element\\", \\"__pairingCurve__\\": \\"SS512\\"}, \\"MONCALAMARIEXPEDIA.COM.SPENDINGLIMIT.LEVEL3\\": {\\"__value__\\": \\"3:TZ12OeNP5Xg+S1RzOOpCSGl+ljs5gCPGcm1/95Y7JBMqO196a31ichI8Kgle7fdD2BuRAO+H7YV5zpLmLv6y7zhmDMv8tN+uqcyepwrzaf5vbXMFmTbLzhjzYl7npWSYCDwzzxeRAFQswrEIaiVBanT4Taq/IUWUhowN2prrx1E=\\", \\"__class__\\": \\"pairing.Element\\", \\"__pairingCurve__\\": \\"SS512\\"}, \\"GLOBAL.PAYMENT.VISA\\": {\\"__value__\\": \\"3:BwloinG3Qw1OalF3pj2Wzq/xT4EGvM0uvgNqtDkE0xQwM4kWAU+QswfGC6vFEaj2nW2tvPOBRnNED/UGBpNKG5wVXTkc1avPu1uaJRJzSHDWLvtEx/WEGpGgDUOrALerRRl8FpcBvmSFyWfopdZkLPFkNHyHsROYCgmfHCl1AuY=\\", \\"__class__\\": \\"pairing.Element\\", \\"__pairingCurve__\\": \\"SS512\\"}}, \\"C2\\": {\\"MONCALAMARIEXPEDIA.COM.SPENDINGLIMIT.LEVEL2\\": {\\"__value__\\": \\"1:UDBK2BkkVad7DH00w+s0nhnt6tgfMhOCcQRCVuftu3cbIJaRYy/1KDQ1bsBlx9fb1UQBP8U4hrzobKa/4YPfJwA=\\", \\"__class__\\": \\"pairing.Element\\", \\"__pairingCurve__\\": \\"SS512\\"}, \\"MONCALAMARIEXPEDIA.COM.SPENDINGLIMIT.LEVEL3\\": {\\"__value__\\": \\"1:Zo+HGUvwARyDDE5qRuHoSPor16+zXcdbVekkmA1gcLGgZcCWcobRNbZiIUJ6+F2CBfCQccJwFkShpFvYiSk3DQE=\\", \\"__class__\\": \\"pairing.Element\\", \\"__pairingCurve__\\": \\"SS512\\"}, \\"GLOBAL.PAYMENT.VISA\\": {\\"__value__\\": \\"1:FPeLC7fv5C1kCIW2QL5dXo1blJem/huVEQdC3EIngvLlOWsAzpn9JlrQdsb6h2V09x+nv0QXxUI1d5CsdUglUAA=\\", \\"__class__\\": \\"pairing.Element\\", \\"__pairingCurve__\\": \\"SS512\\"}}, \\"policy\\": \\"(moncalamariexpedia.com.spendinglimit.level2 OR moncalamariexpedia.com.spendinglimit.level3) AND global.payment.visa\\", \\"C3\\": {\\"MONCALAMARIEXPEDIA.COM.SPENDINGLIMIT.LEVEL2\\": {\\"__value__\\": \\"1:Qb9VAlqbmzWXEFv68bt/SYiRKlcA9ISnKOrSSa3iMEcCUrdRbtS96l1iTBW6D0hCU31mPxu7HUtQK4eaWhOENgE=\\", \\"__class__\\": \\"pairing.Element\\", \\"__pairingCurve__\\": \\"SS512\\"}, \\"MONCALAMARIEXPEDIA.COM.SPENDINGLIMIT.LEVEL3\\": {\\"__value__\\": \\"1:Ss0EGdaMGMMTb3Y1LsEriwGPpZzGyhUoEU+1wWO1z1zONekvxZojoseNiY2B9GktZCaLjT5sME2svotBbwOSRwE=\\", \\"__class__\\": \\"pairing.Element\\", \\"__pairingCurve__\\": \\"SS512\\"}, \\"GLOBAL.PAYMENT.VISA\\": {\\"__value__\\": \\"1:fQ0+xe2xq4To0o4ajpMYsZ7m5Ld+lKhnsFBXsZ7CKhf2abRiS7kK9oxFMB8sUt7EGdFLOf5Q7ht7Jf2UonYtWwA=\\", \\"__class__\\": \\"pairing.Element\\", \\"__pairingCurve__\\": \\"SS512\\"}}}, \\"c2\\": {\\"msg\\": \\"{\\\\\\"MODE\\\\\\": 2, \\\\\\"CipherText\\\\\\": \\\\\\"yDYYJzFOBkRGoPPyH+oa/6nuvIAPL4c/gUfEeQY5uPo=\\\\\\", \\\\\\"IV\\\\\\": \\\\\\"oG/QweyC+1xPUtuOcDS/PQ==\\\\\\", \\\\\\"ALG\\\\\\": 0}\\", \\"digest\\": \\"2467d33efb23442ffb6e2adb18b59b3498b130bb5762c6262b10d5857a37c28f\\", \\"alg\\": \\"HMAC_SHA2\\"}}", "bnonceSignature": {"__value__": "mnPLnIrlitsKt5dHDIOz4fydM3uDIjQK8IKnz7PTC2uLNDlYh+hEs4nkUW9Pqk4kddEHf89CYnmDmSxNKphT/Md6dcX7xBDBstNuQ6CF8IRoD0MpeRXcLA3ONEiSf/kEqS3j6ZNyKj2FrTUicT48OuK1pbWKW22dFgMxNmUDE1BcJfwGHV4MHWNacdeltWyWSmEfObXWFt1f5HbqLxhS1vStYIQzCCtkluliF/j/sss2zLFKKrUqtD7gEpOwFjPcaL40XMkNEurFJc9EGUWhQOdrU6MUrTtraXv+kuLhvhjPQzxNEY7oQrhHl53QOFI3YZDFKceNqlCLcUf59qBUtfabm/sbcDTgfnf4PnaZMAXHQaIECxGxe25wQGNa6EH0mEny6dL5yPXYQmEKI9eT1K631Yyz7B76rtDfy76LNJuPiEW+OrwwXHswqC2EU68wOtMaBJ2UQkM0UPYwA4YOQrtsJciAYH9NqGrsoDZ4yAB0R7Dl3N5t8InvzMt+N79g", "__class__": "bytes"}, "locationServiceCertificate": "-----BEGIN CERTIFICATE-----\\nMIIEhTCCAu0CAgN4MA0GCSqGSIb3DQEBCwUAMIGHMQswCQYDVQQGEwJVUzERMA8G\\nA1UECAwIRGVsYXdhcmUxDzANBgNVBAcMBk5ld2FyazEbMBkGA1UECgwSUHJpc3Rp\\nbmVUZWNoTG9ja2VyMRswGQYDVQQLDBJQcmlzdGluZVRlY2hMb2NrZXIxGjAYBgNV\\nBAMMEWxvdGhhbC12aXJ0dWFsYm94MB4XDTE3MDYxMzIwMDE0M1oXDTE4MDYxMzIw\\nMDE0M1owgYcxCzAJBgNVBAYTAlVTMREwDwYDVQQIDAhEZWxhd2FyZTEPMA0GA1UE\\nBwwGTmV3YXJrMRswGQYDVQQKDBJQcmlzdGluZVRlY2hMb2NrZXIxGzAZBgNVBAsM\\nElByaXN0aW5lVGVjaExvY2tlcjEaMBgGA1UEAwwRbG90aGFsLXZpcnR1YWxib3gw\\nggGiMA0GCSqGSIb3DQEBAQUAA4IBjwAwggGKAoIBgQDXZ5TswNp0UFPPbalnSqKt\\nG+UgvEa7N65Gs7CFJSYhz/8LtoZNuUaUZXU681vWimqcV8IU5fg8AXiWoTzZsJA+\\nYvKm1Ozr4hfcXVJ03J8T2eV3HmCE8n8obYLB+dbnBIa+yM6FxtnJreJx12q7SEHG\\npG2XlX2npHvbE++69864x18JEk2hG1Xc1TIsmhER4KLj99wiQQhhVlqqvjS44/pZ\\nqY4dVx0LOKVie8aOoPp8jkU4ZT4pAiTiUIE7u+JpuyxB6aFO8cEVFIgRyvWiH/QR\\nCulxRQRVxCfCoT0GUtDcy5bc4s8qoLJJBrq7peLHzyjhvG+3Md9nzsuHPzuvKpyQ\\nrtZ0p11PtSUJ9se6mUaoej9BFXmYgiMWkbZxqLXLWjN3rCiDzVufgkBO7UKPmBzv\\nbD5QmDoQBLGbZFIrvJLKUT07cePYscAH4wxYTurKX3hRenOjuJSthFkABUoesRG4\\nF/HyN6g0iST6seNtjsA9UZEeMtO38TWWJ90idyW+lw8CAwEAATANBgkqhkiG9w0B\\nAQsFAAOCAYEAb4vr2CknyMtT7XFvVq32adLn4biU2lR8JPrEsWsmjRA37EL33AON\\n8EInUPHTm2TdeNXazEyxPjJPi4CVfx/tOoENKM5ine1P2+7nDtMI/P1CsJQvPKpc\\nazZdF7i6I4+1vIDfx1c+gp03U4fCCwNpt2fAda5u4IoLp8GVGQxBihXM62CvY3rz\\nFGVWljhrpePIWrTRR+5Y00IlYmTUGGE3P+mOyE3G0kf79rOKNh7eKdvvBWe1jJdC\\nrcNfru0VAlhwD0cJnWf5+CvKfzJU12OjxPQiu74Lx0+EAU7wwsekvM9XdUJetar2\\n/I/XO4oMoIDO51THMVbom+kMpfi3Hx5Lb0LzFYPjOJGgs+AOWXlj+ajmwT/D4H7n\\nxrljb88TO9brCx2dKUJ8Na2U4eRFPXB+Zdiux8HBwskWRQNRcFuTrIAcpYsBmEIv\\npCExcSrn/5RNniw/d09a4vbBH8YUlhU7RnGH6cfq0wUDA0GeuyHiltRMDBbSXUHx\\nJ/QsK3Jyxu5o\\n-----END CERTIFICATE-----\\n"}'
Location Server: waiting for KEi, Ni.
User agent: received BNONCE payload. Now verify signature and attempt decrypting...
User agent: BNONCE signature is valid.
User agent: BNONCE to decrypt is:
 {'c1': {'C0': [2508758638473113770990105090802536095451734593965552402455617892487572584579071446241012609365658574725135170381681664255582036552384808460389811161590967, 6969231598309651673459276906210543453511887146858467319565107479159581802281404342578837566949334781288604455054244387047587531642562007684902904364288931], 'C1': {'MONCALAMARIEXPEDIA.COM.SPENDINGLIMIT.LEVEL2': [3466664529767050929544070349915520384375266581494530453976569189161630766179895502391907097609271567041868113486127030196246433252646995650544283519352538, 8417619086512559818377366629697424671934545640659003649492999631296945457597565432542474816323296282553715135607698216393699000013516100968637464636016695], 'MONCALAMARIEXPEDIA.COM.SPENDINGLIMIT.LEVEL3': [4065031856759821753510231879621269801124942472068616543739862656971205432998657940298040274103957624477289217431810250092233764687482052574732282819949295, 2953836076608370293240520434339171628678428468685798601468385248679820061033131393543617839734993107032051610709113883953690675176543502792772743961757521], 'GLOBAL.PAYMENT.VISA': [368544575922701864056999646149054128502932511222651396562275465341883508342358139495700097038567387001038688686233722864859546829997029368590666464184859, 8174753783362406365543635022975664456882089607381585161250213525729412714919565456542894266810149293742919564523767213670251491958449126017378786729067238]}, 'C2': {'MONCALAMARIEXPEDIA.COM.SPENDINGLIMIT.LEVEL2': [4199819962939563095941816932464535518261804693853554250086913429221203621070235354005727449539266368274226053223160093920744945003006438285982514716860199, 7841182826003510010440816193368042867604547939169896465916585413669958519102543777691886553212379382771036553762963508473941403353266822879345484354945410], 'MONCALAMARIEXPEDIA.COM.SPENDINGLIMIT.LEVEL3': [5371537367244195140443255192801056959887939035957401808041126846035988080423227916729285181459731992089444803219368896367752590184421225784412412511336205, 3237369544954074414632392944570162267931013771265672168640284018401581311309908421798710582452195138976979733700275149961778790005719325811016757349186665], 'GLOBAL.PAYMENT.VISA': [1098129082918800034175260510194889508373398092932835099172701920005624246967237829204119091887878285389849643833267794432273459785042610247057463143048528, 2442046384515594930373441553962634966632027413634645864874972848145168786494215554660546061838578031391110576364635698960268018728288270338400689771269616]}, 'policy': '(moncalamariexpedia.com.spendinglimit.level2 OR moncalamariexpedia.com.spendinglimit.level3) AND global.payment.visa', 'C3': {'MONCALAMARIEXPEDIA.COM.SPENDINGLIMIT.LEVEL2': [3443470269190601605550832952163186182387537614045662045060646870524878405125355626548372216351973149074071358382992542221112869126041635012030404041606198, 1677800080682112046830140517880381958349315153356526951745581840652414965402281626984073338499826191947058784697225865333315389562239213621944037377029261], 'MONCALAMARIEXPEDIA.COM.SPENDINGLIMIT.LEVEL3': [3917638074243190633915601792170541381257228896050110894077275287331974262276905385375925415638736582856314803773069962016704942747396975045803455635755591, 6004533609237866647140425345495935348504642499150496062755562141091578569945134222702347524720376493799303915125567708399239730407104340249282651716226735], 'GLOBAL.PAYMENT.VISA': [6549491011937173808934369858519618366349159543507584756376074425331858678543638668965684093163993255293677079963243027534609819584272320072456197528497499, 6912991334574775685073035145316538992754954059042586431865601966860643988740088831647828331697944600619217808941477893512745352473968349735289770944191526]}}, 'c2': {'msg': '{"MODE": 2, "CipherText": "yDYYJzFOBkRGoPPyH+oa/6nuvIAPL4c/gUfEeQY5uPo=", "IV": "oG/QweyC+1xPUtuOcDS/PQ==", "ALG": 0}', 'alg': 'HMAC_SHA2', 'digest': '2467d33efb23442ffb6e2adb18b59b3498b130bb5762c6262b10d5857a37c28f'}}
User agent: BNONCE decryption successful.
User agent: BNONCE_RECEIVED.
User agent: processing state:  State.BROADCAST_ECDHE_SEND_KEI_NI
User agent: processBroadcastEcdheSendKeiNi.
User agent: sending KEi, Ni...
user.agent  simulator, send raw message:
Location Server: received KEi, Ni.
 b'\x00\x00\x01(h%B\xc3\x8fI\x9av(Y_(vh\n\x05(k\x00\x00\x00\x00\x00\x00{"kei": {"__value__": "1:WUoLpwxiURRbj0Eb1TKJXUsXcOw57yvfi8bnuJn1DWX+4hQRfG4hHd8si3XfbEHq/ItIMZhknKYuLPinO/267QE=", "__class__": "pairing.Element", "__pairingCurve__": "SS512"}, "ni": {"__value__": "G7zTBdbmGevQlcU04qJ6tDzZg1Sg48aUGpooO6a7C44=", "__class__": "bytes"}}'
Location Server: KEI_NI_RECEIVED, variables set.
User agent: KEi, Ni sent. Waiting for KEr, Nr...
Location Server: processing state:  State.BROADCAST_ECDHE_SEND_KER_NR
Location Server: sending KEr, Nr.
location.service.agent  simulator, send raw message:
User agent: received KEr, Nr.
 b'\x00\x00\x01(h%B\xc3\x8fI\x9av(Y_(vh\n\x05\x00k\x00\x00\x00\x00\x00\x02{"nr": {"__value__": "Rp5YqYu7YELygcdbbXkxwbDOiZV1h/XpfhLzmOeJbHg=", "__class__": "bytes"}, "ker": {"__value__": "1:FwPN74qNYXEju2nyk0LTiVhqfMCZMhRyg2/lhWwQ6zcnadDxlJJDXTEnANjdWPS2LRjG9vpmDreZaBoZkxckcAE=", "__class__": "pairing.Element", "__pairingCurve__": "SS512"}}'
User agent: proceeding to compute shared secrets.
Location Server: proceeding to compute shared secrets.
location.service.agent : computeEcdheSecrets.
user.agent : computeEcdheSecrets.
location.service.agent : sharedSecret:  [8136702497780536400351036892696519521085858791295450598766048957737732248742970636743468822250106598796525162254897979744571652291817711614204131309647811, 7396748977405963060526873954324217766803716897455925932710291526172380382798101699112419711143997355948408512013800037183629199855516843208500988564451016]
location.service.agent : keyMaterial:  b'\x9e\xec\x02=\xa1O\xe9gM\xab\xe0,\x02\xef\xaajL\x98\x96\xb5\xdd\xf7\xd7w9Mx]G(\xba\xcf2\x18\xe3\x8f\x80\x90\xa6\x93>\xef\xc4\xcf\x85\xf1\xee\x10\xe5\xa9\xd2\\m\x1544}R\xadGZ\x92\xe6AU\xd7\x86\xe1mz\xc7\xba\xf6?\x8f\x17\xff+u\xb0\xfa\x15\x8aJz\xce\xb8\x0bFB\nT\xc2t\xef\xb6\x17\x85\xdc\x9e\xa0\x06*\xfd\xf2$G\xdb\xfc\xe4\xa3\xd4\xf9\x9a\x1c\xf4\xe1\xab\xad\x88\xff^Y{\x12\x15;\x96\xb0Y\xfdU\xaf\xd1\x13\x96c\x18\x8ca\xe8\xec\xe5G\x0ew3\x9d\xc8_\xec$\xa3\xc3\n\x8dT\xe4\x9c\xdb\xec\x962\xabQ\xb2\xd2fa\xacM\xf2\x08^\xf9OM\x13\x97#\xf9\xd9\xcbY\x0e\x14,\xb5\x07{P\xda\xa7o\x1cEQ\x0cK\xa27\xca\x97\xe7\xb7\xde\xaf\xcf\x04\x8da\x88\x80\xdc\x04S\xa7\x9a~\xe0U\xd9\xd9i\xef:D2\x8f\xd4\x1epKF\xf0b\xf4\x99>\xe6\x1d\x15@\x1e\xf4#\x19$\xa4\xfa\xf4\xfa\x93\xa4s6'
user.agent : sharedSecret:  [8136702497780536400351036892696519521085858791295450598766048957737732248742970636743468822250106598796525162254897979744571652291817711614204131309647811, 7396748977405963060526873954324217766803716897455925932710291526172380382798101699112419711143997355948408512013800037183629199855516843208500988564451016]
location.service.agent : created shared secrets.
user.agent : keyMaterial:  b'\x9e\xec\x02=\xa1O\xe9gM\xab\xe0,\x02\xef\xaajL\x98\x96\xb5\xdd\xf7\xd7w9Mx]G(\xba\xcf2\x18\xe3\x8f\x80\x90\xa6\x93>\xef\xc4\xcf\x85\xf1\xee\x10\xe5\xa9\xd2\\m\x1544}R\xadGZ\x92\xe6AU\xd7\x86\xe1mz\xc7\xba\xf6?\x8f\x17\xff+u\xb0\xfa\x15\x8aJz\xce\xb8\x0bFB\nT\xc2t\xef\xb6\x17\x85\xdc\x9e\xa0\x06*\xfd\xf2$G\xdb\xfc\xe4\xa3\xd4\xf9\x9a\x1c\xf4\xe1\xab\xad\x88\xff^Y{\x12\x15;\x96\xb0Y\xfdU\xaf\xd1\x13\x96c\x18\x8ca\xe8\xec\xe5G\x0ew3\x9d\xc8_\xec$\xa3\xc3\n\x8dT\xe4\x9c\xdb\xec\x962\xabQ\xb2\xd2fa\xacM\xf2\x08^\xf9OM\x13\x97#\xf9\xd9\xcbY\x0e\x14,\xb5\x07{P\xda\xa7o\x1cEQ\x0cK\xa27\xca\x97\xe7\xb7\xde\xaf\xcf\x04\x8da\x88\x80\xdc\x04S\xa7\x9a~\xe0U\xd9\xd9i\xef:D2\x8f\xd4\x1epKF\xf0b\xf4\x99>\xe6\x1d\x15@\x1e\xf4#\x19$\xa4\xfa\xf4\xfa\x93\xa4s6'
Location Server: SHARED_SECRETS_COMPUTED.
user.agent : created shared secrets.
User agent: SHARED_SECRETS_COMPUTED.
Location Server: processing state:  State.TIER1_PRIVACY_AUTHENTICATION
Location Server: processTier1PrivacyAuthentication.
Current messageContainer:
 {'signedOctetsIdrPayload': b'{"service": "LOCAUTH Service", "uuid": "10caa7h0-5e12-71ce-010c-a7hebeac0140"}', 'signedOctetsKerNrRawMessage': b'\x00\x00\x01(h%B\xc3\x8fI\x9av(Y_(vh\n\x05\x00k\x00\x00\x00\x00\x00\x02{"nr": {"__value__": "Rp5YqYu7YELygcdbbXkxwbDOiZV1h/XpfhLzmOeJbHg=", "__class__": "bytes"}, "ker": {"__value__": "1:FwPN74qNYXEju2nyk0LTiVhqfMCZMhRyg2/lhWwQ6zcnadDxlJJDXTEnANjdWPS2LRjG9vpmDreZaBoZkxckcAE=", "__class__": "pairing.Element", "__pairingCurve__": "SS512"}}', 'signedOctetsKeiNiRawMessage': b'\x00\x00\x01(h%B\xc3\x8fI\x9av(Y_(vh\n\x05(k\x00\x00\x00\x00\x00\x00{"kei": {"__value__": "1:WUoLpwxiURRbj0Eb1TKJXUsXcOw57yvfi8bnuJn1DWX+4hQRfG4hHd8si3XfbEHq/ItIMZhknKYuLPinO/267QE=", "__class__": "pairing.Element", "__pairingCurve__": "SS512"}, "ni": {"__value__": "G7zTBdbmGevQlcU04qJ6tDzZg1Sg48aUGpooO6a7C44=", "__class__": "bytes"}}'}
User agent: processing state:  State.TIER1_PRIVACY_AUTHENTICATION
User agent: processTier1PrivacyAuthentication.
Current messageContainer:
 {'signedOctetsIdrPayload': b'{"service": "LOCAUTH Service", "uuid": "10caa7h0-5e12-71ce-010c-a7hebeac0140"}', 'signedOctetsKerNrRawMessage': b'\x00\x00\x01(h%B\xc3\x8fI\x9av(Y_(vh\n\x05\x00k\x00\x00\x00\x00\x00\x02{"nr": {"__value__": "Rp5YqYu7YELygcdbbXkxwbDOiZV1h/XpfhLzmOeJbHg=", "__class__": "bytes"}, "ker": {"__value__": "1:FwPN74qNYXEju2nyk0LTiVhqfMCZMhRyg2/lhWwQ6zcnadDxlJJDXTEnANjdWPS2LRjG9vpmDreZaBoZkxckcAE=", "__class__": "pairing.Element", "__pairingCurve__": "SS512"}}', 'signedOctetsKeiNiRawMessage': b'\x00\x00\x01(h%B\xc3\x8fI\x9av(Y_(vh\n\x05(k\x00\x00\x00\x00\x00\x00{"kei": {"__value__": "1:WUoLpwxiURRbj0Eb1TKJXUsXcOw57yvfi8bnuJn1DWX+4hQRfG4hHd8si3XfbEHq/ItIMZhknKYuLPinO/267QE=", "__class__": "pairing.Element", "__pairingCurve__": "SS512"}, "ni": {"__value__": "G7zTBdbmGevQlcU04qJ6tDzZg1Sg48aUGpooO6a7C44=", "__class__": "bytes"}}'}
User agent: authTier1i:  b'\xd5\xfb%\x06fm]\xb7\xa31\x1e\xf2p7\xf4\xe0\xc0\x05\xcc\xccq\x853\x9b\x9e\xff\x9b\x9b\xdb\x93\xcf\xdc' 
Length:  32
user.agent  simulator, send encrypted message: plaintext is:
 {'authTier1i': b'\xd5\xfb%\x06fm]\xb7\xa31\x1e\xf2p7\xf4\xe0\xc0\x05\xcc\xccq\x853\x9b\x9e\xff\x9b\x9b\xdb\x93\xcf\xdc'}
location.service.agent : receiveEncryptedMessage dict:
user.agent  simulator, send encrypted raw message:
 {'authTier1i': b'\xd5\xfb%\x06fm]\xb7\xa31\x1e\xf2p7\xf4\xe0\xc0\x05\xcc\xccq\x853\x9b\x9e\xff\x9b\x9b\xdb\x93\xcf\xdc', 'rawMessage': b'\x00\x00\x01vh%B\xc3\x8fI\x9av(Y_(vh\n\x05(1\x00\x00\x00\x00\x00\x01{"msg": "{\\"MODE\\": 2, \\"CipherText\\": \\"qM/6zpYug3gEzboSae2xgddm6clqsfhcKJDniV9ZG1omiMxvVZY94HqvTNjDcdEpV4cENPiLpiMDZdLDHNnXVrEk+oEJOdyXGCPg6eSCvjEYO+VDiQUD0cofG1MTncT552ZULEBG8iSQx1DLEmPFPw==\\", \\"IV\\": \\"jRzmqZKWk1+c/vSI4EuAWg==\\", \\"ALG\\": 0}", "digest": "1e182e9e941a2a8bdbee2e8f463ddb41c4328068fbf11de1674d2ae51dfed1b8", "alg": "HMAC_SHA2"}', 'header': {'spir': b'(Y_(vh\n\x05', 'spii': b'h%B\xc3\x8fI\x9av', 'length': 374, 'sender': True, 'counter': 1, 'exchange_type': b'1', 'message_type': True}}
Location Server: authTier1i:  b'\xd5\xfb%\x06fm]\xb7\xa31\x1e\xf2p7\xf4\xe0\xc0\x05\xcc\xccq\x853\x9b\x9e\xff\x9b\x9b\xdb\x93\xcf\xdc' 
Length:  b'\x00\x00\x01vh%B\xc3\x8fI\x9av(Y_(vh\n\x05(1\x00\x00\x00\x00\x00\x01{"msg": "{\\"MODE\\": 2, \\"CipherText\\": \\"qM/6zpYug3gEzboSae2xgddm6clqsfhcKJDniV9ZG1omiMxvVZY94HqvTNjDcdEpV4cENPiLpiMDZdLDHNnXVrEk+oEJOdyXGCPg6eSCvjEYO+VDiQUD0cofG1MTncT552ZULEBG8iSQx1DLEmPFPw==\\", \\"IV\\": \\"jRzmqZKWk1+c/vSI4EuAWg==\\", \\"ALG\\": 0}", "digest": "1e182e9e941a2a8bdbee2e8f463ddb41c4328068fbf11de1674d2ae51dfed1b8", "alg": "HMAC_SHA2"}'
 32
User agent: AUTH_TIER1i sent:
Location Server: authTier1iLocal type:  <class 'bytes'> b'\xd5\xfb%\x06fm]\xb7\xa31\x1e\xf2p7\xf4\xe0\xc0\x05\xcc\xccq\x853\x9b\x9e\xff\x9b\x9b\xdb\x93\xcf\xdc'
 b'\x00\x00\x01vh%B\xc3\x8fI\x9av(Y_(vh\n\x05(1\x00\x00\x00\x00\x00\x01{"msg": "{\\"MODE\\": 2, \\"CipherText\\": \\"qM/6zpYug3gEzboSae2xgddm6clqsfhcKJDniV9ZG1omiMxvVZY94HqvTNjDcdEpV4cENPiLpiMDZdLDHNnXVrEk+oEJOdyXGCPg6eSCvjEYO+VDiQUD0cofG1MTncT552ZULEBG8iSQx1DLEmPFPw==\\", \\"IV\\": \\"jRzmqZKWk1+c/vSI4EuAWg==\\", \\"ALG\\": 0}", "digest": "1e182e9e941a2a8bdbee2e8f463ddb41c4328068fbf11de1674d2ae51dfed1b8", "alg": "HMAC_SHA2"}'
Location Server: authTier1iReceived type:  <class 'bytes'> b'\xd5\xfb%\x06fm]\xb7\xa31\x1e\xf2p7\xf4\xe0\xc0\x05\xcc\xccq\x853\x9b\x9e\xff\x9b\x9b\xdb\x93\xcf\xdc'
location.service.agent  simulator, send encrypted message: plaintext is:
 {'idr': {'service': 'LOCAUTH Service', 'uuid': '10caa7h0-5e12-71ce-010c-a7hebeac0140'}, 'locationServiceCertificate': '-----BEGIN CERTIFICATE-----\nMIIEhTCCAu0CAgN4MA0GCSqGSIb3DQEBCwUAMIGHMQswCQYDVQQGEwJVUzERMA8G\nA1UECAwIRGVsYXdhcmUxDzANBgNVBAcMBk5ld2FyazEbMBkGA1UECgwSUHJpc3Rp\nbmVUZWNoTG9ja2VyMRswGQYDVQQLDBJQcmlzdGluZVRlY2hMb2NrZXIxGjAYBgNV\nBAMMEWxvdGhhbC12aXJ0dWFsYm94MB4XDTE3MDYxMzIwMDE0M1oXDTE4MDYxMzIw\nMDE0M1owgYcxCzAJBgNVBAYTAlVTMREwDwYDVQQIDAhEZWxhd2FyZTEPMA0GA1UE\nBwwGTmV3YXJrMRswGQYDVQQKDBJQcmlzdGluZVRlY2hMb2NrZXIxGzAZBgNVBAsM\nElByaXN0aW5lVGVjaExvY2tlcjEaMBgGA1UEAwwRbG90aGFsLXZpcnR1YWxib3gw\nggGiMA0GCSqGSIb3DQEBAQUAA4IBjwAwggGKAoIBgQDXZ5TswNp0UFPPbalnSqKt\nG+UgvEa7N65Gs7CFJSYhz/8LtoZNuUaUZXU681vWimqcV8IU5fg8AXiWoTzZsJA+\nYvKm1Ozr4hfcXVJ03J8T2eV3HmCE8n8obYLB+dbnBIa+yM6FxtnJreJx12q7SEHG\npG2XlX2npHvbE++69864x18JEk2hG1Xc1TIsmhER4KLj99wiQQhhVlqqvjS44/pZ\nqY4dVx0LOKVie8aOoPp8jkU4ZT4pAiTiUIE7u+JpuyxB6aFO8cEVFIgRyvWiH/QR\nCulxRQRVxCfCoT0GUtDcy5bc4s8qoLJJBrq7peLHzyjhvG+3Md9nzsuHPzuvKpyQ\nrtZ0p11PtSUJ9se6mUaoej9BFXmYgiMWkbZxqLXLWjN3rCiDzVufgkBO7UKPmBzv\nbD5QmDoQBLGbZFIrvJLKUT07cePYscAH4wxYTurKX3hRenOjuJSthFkABUoesRG4\nF/HyN6g0iST6seNtjsA9UZEeMtO38TWWJ90idyW+lw8CAwEAATANBgkqhkiG9w0B\nAQsFAAOCAYEAb4vr2CknyMtT7XFvVq32adLn4biU2lR8JPrEsWsmjRA37EL33AON\n8EInUPHTm2TdeNXazEyxPjJPi4CVfx/tOoENKM5ine1P2+7nDtMI/P1CsJQvPKpc\nazZdF7i6I4+1vIDfx1c+gp03U4fCCwNpt2fAda5u4IoLp8GVGQxBihXM62CvY3rz\nFGVWljhrpePIWrTRR+5Y00IlYmTUGGE3P+mOyE3G0kf79rOKNh7eKdvvBWe1jJdC\nrcNfru0VAlhwD0cJnWf5+CvKfzJU12OjxPQiu74Lx0+EAU7wwsekvM9XdUJetar2\n/I/XO4oMoIDO51THMVbom+kMpfi3Hx5Lb0LzFYPjOJGgs+AOWXlj+ajmwT/D4H7n\nxrljb88TO9brCx2dKUJ8Na2U4eRFPXB+Zdiux8HBwskWRQNRcFuTrIAcpYsBmEIv\npCExcSrn/5RNniw/d09a4vbBH8YUlhU7RnGH6cfq0wUDA0GeuyHiltRMDBbSXUHx\nJ/QsK3Jyxu5o\n-----END CERTIFICATE-----\n', 'authTier1rSignature': b'\xa8r\x16\xa2\xd6\xe4C\xc6I?\x91b\x85[\x1f\xcf\xe9\xb4m\xdem\x96\x1d\xb5\xa4\xeb\x9dr \x12\xc5\xbe\x84m\x1e\xe3j\xb17Y\x9b\xcd\xb6B\xc4^t\xdcB\x14_\x1a\x82\xcc\xae\\\xe4\xb1j\xf3\xd9\x92\x13\xd3:ZX\x00\xde@c\x17\xae2\xcc\x1a\xef)\x9e\x9c\xc5\xf8\x0e\x1dZ\x08\xa0\x91d\x05\xe1\x1d\\\x89\xc0@\xfd\x1c\x9b|-\x13\x90\xaa+;\xe4\xcd\x8c\xe6WO\xc1\x16\x06\xed8\xbb\x81#\xf3\xed\x02H^7\xb2\x05\x9a(\xc5\x08Y\xf7\x13\xec\xbe\x05\x0fBv\x96?X\xe9\n\x13WNb\xea[\xccM\x87\xdd\x044B\xe4%k\x90\x91\x05q\x9d\xe6\x17\xf9\xec\xb6\xd7Qd(\xdc{\x0cGu\xf1\x14\xdb\x05 \xaa\xe8WeEa\xa7\xea\xac\x12\xf8z\x91\xf1w\xd4d\x92C\xdcN\x80\xe4@VpF}?\x12w\xc2K\x0b,\xf2\xddyH\xb2n\xe7\xfa\x8e\x81\xe0%[\xbc\xb1\x99\xf1kS\x97\xfa\x89F\xb2\xf2\xbd\x18\x8as\xe7\xba\x94\xac\xe8O~\xf5\t\x7fb\xe9>\xe3">1wn\x03\r\x9d\x7f\x1d\x1b\xda\xbd\x08\x0cU\xbcE(\xa5/\xebQ|\r\x94\xb9\xbd\xe5\xe4\x1b\xd2\x18\xc0\xb9\x1e\x95Z<oe\xe1#\x8bi\xc5\xed\xcc\xc7\x87\xf6{\xbd\'\x7f\xf1@\xa4\x97\xd7\xd0\xef\x19\x93\x83\xd5\xa2\xedG>\xa9q\x0e\x8bY\x14u\xda\xd82f\xcf\x10\x95u9\xda\xb1\x1azxS\xfc\xbd\xe3\xe4V\x83\x87\xdb\x1cONITDQ\xec\x85\x9b\x9e\xec\xbf\xbd\xedB\x0ct\x88F', 'authTier1r': b'\x9c\xfc\xea\xa5_\xc6\x07\xa9\xc0?\xd9\xf8\x86\x99U\x9d\r\xa5J\xe0\x02O\x94n#R$\x7f2GK;'}
user.agent : receiveEncryptedMessage dict:
 {'header': {'spir': b'(Y_(vh\n\x05', 'spii': b'h%B\xc3\x8fI\x9av', 'length': 3510, 'sender': False, 'counter': 3, 'exchange_type': b'1', 'message_type': False}, 'authTier1rSignature': b'\xa8r\x16\xa2\xd6\xe4C\xc6I?\x91b\x85[\x1f\xcf\xe9\xb4m\xdem\x96\x1d\xb5\xa4\xeb\x9dr \x12\xc5\xbe\x84m\x1e\xe3j\xb17Y\x9b\xcd\xb6B\xc4^t\xdcB\x14_\x1a\x82\xcc\xae\\\xe4\xb1j\xf3\xd9\x92\x13\xd3:ZX\x00\xde@c\x17\xae2\xcc\x1a\xef)\x9e\x9c\xc5\xf8\x0e\x1dZ\x08\xa0\x91d\x05\xe1\x1d\\\x89\xc0@\xfd\x1c\x9b|-\x13\x90\xaa+;\xe4\xcd\x8c\xe6WO\xc1\x16\x06\xed8\xbb\x81#\xf3\xed\x02H^7\xb2\x05\x9a(\xc5\x08Y\xf7\x13\xec\xbe\x05\x0fBv\x96?X\xe9\n\x13WNb\xea[\xccM\x87\xdd\x044B\xe4%k\x90\x91\x05q\x9d\xe6\x17\xf9\xec\xb6\xd7Qd(\xdc{\x0cGu\xf1\x14\xdb\x05 \xaa\xe8WeEa\xa7\xea\xac\x12\xf8z\x91\xf1w\xd4d\x92C\xdcN\x80\xe4@VpF}?\x12w\xc2K\x0b,\xf2\xddyH\xb2n\xe7\xfa\x8e\x81\xe0%[\xbc\xb1\x99\xf1kS\x97\xfa\x89F\xb2\xf2\xbd\x18\x8as\xe7\xba\x94\xac\xe8O~\xf5\t\x7fb\xe9>\xe3">1wn\x03\r\x9d\x7f\x1d\x1b\xda\xbd\x08\x0cU\xbcE(\xa5/\xebQ|\r\x94\xb9\xbd\xe5\xe4\x1b\xd2\x18\xc0\xb9\x1e\x95Z<oe\xe1#\x8bi\xc5\xed\xcc\xc7\x87\xf6{\xbd\'\x7f\xf1@\xa4\x97\xd7\xd0\xef\x19\x93\x83\xd5\xa2\xedG>\xa9q\x0e\x8bY\x14u\xda\xd82f\xcf\x10\x95u9\xda\xb1\x1azxS\xfc\xbd\xe3\xe4V\x83\x87\xdb\x1cONITDQ\xec\x85\x9b\x9e\xec\xbf\xbd\xedB\x0ct\x88F', 'authTier1r': b'\x9c\xfc\xea\xa5_\xc6\x07\xa9\xc0?\xd9\xf8\x86\x99U\x9d\r\xa5J\xe0\x02O\x94n#R$\x7f2GK;', 'idr': {'service': 'LOCAUTH Service', 'uuid': '10caa7h0-5e12-71ce-010c-a7hebeac0140'}, 'rawMessage': b'\x00\x00\r\xb6h%B\xc3\x8fI\x9av(Y_(vh\n\x05\x001\x00\x00\x00\x00\x00\x03{"msg": "{\\"MODE\\": 2, \\"CipherText\\": \\"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\\", \\"IV\\": \\"UKklU7Knydt1ou5s1Az9kQ==\\", \\"ALG\\": 0}", "digest": "41f00b9c04b32fece4b6879cc3f2112d62439d03fd85fbc38d8d38209f0a088c", "alg": "HMAC_SHA2"}', 'locationServiceCertificate': '-----BEGIN CERTIFICATE-----\nMIIEhTCCAu0CAgN4MA0GCSqGSIb3DQEBCwUAMIGHMQswCQYDVQQGEwJVUzERMA8G\nA1UECAwIRGVsYXdhcmUxDzANBgNVBAcMBk5ld2FyazEbMBkGA1UECgwSUHJpc3Rp\nbmVUZWNoTG9ja2VyMRswGQYDVQQLDBJQcmlzdGluZVRlY2hMb2NrZXIxGjAYBgNV\nBAMMEWxvdGhhbC12aXJ0dWFsYm94MB4XDTE3MDYxMzIwMDE0M1oXDTE4MDYxMzIw\nMDE0M1owgYcxCzAJBgNVBAYTAlVTMREwDwYDVQQIDAhEZWxhd2FyZTEPMA0GA1UE\nBwwGTmV3YXJrMRswGQYDVQQKDBJQcmlzdGluZVRlY2hMb2NrZXIxGzAZBgNVBAsM\nElByaXN0aW5lVGVjaExvY2tlcjEaMBgGA1UEAwwRbG90aGFsLXZpcnR1YWxib3gw\nggGiMA0GCSqGSIb3DQEBAQUAA4IBjwAwggGKAoIBgQDXZ5TswNp0UFPPbalnSqKt\nG+UgvEa7N65Gs7CFJSYhz/8LtoZNuUaUZXU681vWimqcV8IU5fg8AXiWoTzZsJA+\nYvKm1Ozr4hfcXVJ03J8T2eV3HmCE8n8obYLB+dbnBIa+yM6FxtnJreJx12q7SEHG\npG2XlX2npHvbE++69864x18JEk2hG1Xc1TIsmhER4KLj99wiQQhhVlqqvjS44/pZ\nqY4dVx0LOKVie8aOoPp8jkU4ZT4pAiTiUIE7u+JpuyxB6aFO8cEVFIgRyvWiH/QR\nCulxRQRVxCfCoT0GUtDcy5bc4s8qoLJJBrq7peLHzyjhvG+3Md9nzsuHPzuvKpyQ\nrtZ0p11PtSUJ9se6mUaoej9BFXmYgiMWkbZxqLXLWjN3rCiDzVufgkBO7UKPmBzv\nbD5QmDoQBLGbZFIrvJLKUT07cePYscAH4wxYTurKX3hRenOjuJSthFkABUoesRG4\nF/HyN6g0iST6seNtjsA9UZEeMtO38TWWJ90idyW+lw8CAwEAATANBgkqhkiG9w0B\nAQsFAAOCAYEAb4vr2CknyMtT7XFvVq32adLn4biU2lR8JPrEsWsmjRA37EL33AON\n8EInUPHTm2TdeNXazEyxPjJPi4CVfx/tOoENKM5ine1P2+7nDtMI/P1CsJQvPKpc\nazZdF7i6I4+1vIDfx1c+gp03U4fCCwNpt2fAda5u4IoLp8GVGQxBihXM62CvY3rz\nFGVWljhrpePIWrTRR+5Y00IlYmTUGGE3P+mOyE3G0kf79rOKNh7eKdvvBWe1jJdC\nrcNfru0VAlhwD0cJnWf5+CvKfzJU12OjxPQiu74Lx0+EAU7wwsekvM9XdUJetar2\n/I/XO4oMoIDO51THMVbom+kMpfi3Hx5Lb0LzFYPjOJGgs+AOWXlj+ajmwT/D4H7n\nxrljb88TO9brCx2dKUJ8Na2U4eRFPXB+Zdiux8HBwskWRQNRcFuTrIAcpYsBmEIv\npCExcSrn/5RNniw/d09a4vbBH8YUlhU7RnGH6cfq0wUDA0GeuyHiltRMDBbSXUHx\nJ/QsK3Jyxu5o\n-----END CERTIFICATE-----\n'}
User agent: authTier1rLocal (expected):
 b'\x9c\xfc\xea\xa5_\xc6\x07\xa9\xc0?\xd9\xf8\x86\x99U\x9d\r\xa5J\xe0\x02O\x94n#R$\x7f2GK;'
location.service.agent  simulator, send encrypted raw message:
User agent: authTier1rReceived:
 b'\x9c\xfc\xea\xa5_\xc6\x07\xa9\xc0?\xd9\xf8\x86\x99U\x9d\r\xa5J\xe0\x02O\x94n#R$\x7f2GK;'
 b'\x00\x00\r\xb6h%B\xc3\x8fI\x9av(Y_(vh\n\x05\x001\x00\x00\x00\x00\x00\x03{"msg": "{\\"MODE\\": 2, \\"CipherText\\": \\"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\\", \\"IV\\": \\"UKklU7Knydt1ou5s1Az9kQ==\\", \\"ALG\\": 0}", "digest": "41f00b9c04b32fece4b6879cc3f2112d62439d03fd85fbc38d8d38209f0a088c", "alg": "HMAC_SHA2"}'
Location Server: AUTH_TIER1r sent:
User agent: valid AUTH_TIER1r signature
 b'\x00\x00\r\xb6h%B\xc3\x8fI\x9av(Y_(vh\n\x05\x001\x00\x00\x00\x00\x00\x03{"msg": "{\\"MODE\\": 2, \\"CipherText\\": \\"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\\", \\"IV\\": \\"UKklU7Knydt1ou5s1Az9kQ==\\", \\"ALG\\": 0}", "digest": "41f00b9c04b32fece4b6879cc3f2112d62439d03fd85fbc38d8d38209f0a088c", "alg": "HMAC_SHA2"}'
Location Server: processing state:  State.TIER2_PRIVACY_AUTHENTICATION
User agent: processing state:  State.TIER2_PRIVACY_AUTHENTICATION
user.agent  simulator, send encrypted message: plaintext is:
 {'enonce': '{"MODE": 2, "CipherText": "JTNVfsczPfQEw1I+nY4DBRex0+UDdqTS4sPv9fJk3r3dvPCNR2VFC8OCjA1gEAu4", "IV": "32XaZpryITwLGYed4iXipQ==", "ALG": 0}', 'idi': 'gialackbar@live.com', 'authenticationKeyType': 'Password Hash (KDF)', 'authTier2i': b'\x8b\xde\xeeK\x0bI\x11\x0b:\x0fQK\x80,\xd7\x9a{\xfd\x8e\xa9\xe8\xc4\xcf\xc7Y\xcc\x1a\x0f\x8c\x9e1\x0f'}
location.service.agent : receiveEncryptedMessage dict:
user.agent  simulator, send encrypted raw message:
 {'enonce': '{"MODE": 2, "CipherText": "JTNVfsczPfQEw1I+nY4DBRex0+UDdqTS4sPv9fJk3r3dvPCNR2VFC8OCjA1gEAu4", "IV": "32XaZpryITwLGYed4iXipQ==", "ALG": 0}', 'authenticationKeyType': 'Password Hash (KDF)', 'authTier2i': b'\x8b\xde\xeeK\x0bI\x11\x0b:\x0fQK\x80,\xd7\x9a{\xfd\x8e\xa9\xe8\xc4\xcf\xc7Y\xcc\x1a\x0f\x8c\x9e1\x0f', 'idi': 'gialackbar@live.com', 'rawMessage': b'\x00\x00\x02\xb6h%B\xc3\x8fI\x9av(Y_(vh\n\x05(2\x00\x00\x00\x00\x00\x02{"msg": "{\\"MODE\\": 2, \\"CipherText\\": \\"4MJ2V5fveW1d9mKdXJP98itEVLkO48f6evEyfBJ/vwkWH5gjBwYf1N0O0BqSCONH18XKgi1Rw4e0ooz59n8qMoe/iLMEC2aTUJtbMX5KY0hLOPTgpSDul0hlnmgJG2RV5EuWBH/axK6v4oaMi24H28wtyfvSeU8c89767blWFSk235gH31AdhrXRel4dCbunvm8hg7wyFVnOXrsfp4ll96m4tNxc01kY8/BAS3R8LPiyLEL46haugcT/TeyH0T19bSV5kyVrjJevJqvpsEUXwEtoJ0wCijPRjs70tD/0BScdeHZVyBrRGbOsMZonVBCx2o17R7DBubSZpmUZXeoiRXm+Mz3MYz5m6YLWp+WkeUeSRrMo/8Um7cXb+MObA05sIXtoRYmPH/Jviux5ihlBDQyWesSC3ZBANE2sxF71y3M6VTr1fPjBKZdiiR+Aqg68qDa60/OrUFjDHjz2vnCYoA==\\", \\"IV\\": \\"e7m3aiZdDXfquoJaa+a76A==\\", \\"ALG\\": 0}", "digest": "c5f0276a14ad92137f62bea1d93c23d65c956171fb7be0094edfce65c60d5933", "alg": "HMAC_SHA2"}', 'header': {'spir': b'(Y_(vh\n\x05', 'spii': b'h%B\xc3\x8fI\x9av', 'length': 694, 'sender': True, 'counter': 2, 'exchange_type': b'2', 'message_type': True}}
 b'\x00\x00\x02\xb6h%B\xc3\x8fI\x9av(Y_(vh\n\x05(2\x00\x00\x00\x00\x00\x02{"msg": "{\\"MODE\\": 2, \\"CipherText\\": \\"4MJ2V5fveW1d9mKdXJP98itEVLkO48f6evEyfBJ/vwkWH5gjBwYf1N0O0BqSCONH18XKgi1Rw4e0ooz59n8qMoe/iLMEC2aTUJtbMX5KY0hLOPTgpSDul0hlnmgJG2RV5EuWBH/axK6v4oaMi24H28wtyfvSeU8c89767blWFSk235gH31AdhrXRel4dCbunvm8hg7wyFVnOXrsfp4ll96m4tNxc01kY8/BAS3R8LPiyLEL46haugcT/TeyH0T19bSV5kyVrjJevJqvpsEUXwEtoJ0wCijPRjs70tD/0BScdeHZVyBrRGbOsMZonVBCx2o17R7DBubSZpmUZXeoiRXm+Mz3MYz5m6YLWp+WkeUeSRrMo/8Um7cXb+MObA05sIXtoRYmPH/Jviux5ihlBDQyWesSC3ZBANE2sxF71y3M6VTr1fPjBKZdiiR+Aqg68qDa60/OrUFjDHjz2vnCYoA==\\", \\"IV\\": \\"e7m3aiZdDXfquoJaa+a76A==\\", \\"ALG\\": 0}", "digest": "c5f0276a14ad92137f62bea1d93c23d65c956171fb7be0094edfce65c60d5933", "alg": "HMAC_SHA2"}'
User agent: AUTH_TIER2i, ENONCE, keyType, IDi sent:
 b'\x00\x00\x02\xb6h%B\xc3\x8fI\x9av(Y_(vh\n\x05(2\x00\x00\x00\x00\x00\x02{"msg": "{\\"MODE\\": 2, \\"CipherText\\": \\"4MJ2V5fveW1d9mKdXJP98itEVLkO48f6evEyfBJ/vwkWH5gjBwYf1N0O0BqSCONH18XKgi1Rw4e0ooz59n8qMoe/iLMEC2aTUJtbMX5KY0hLOPTgpSDul0hlnmgJG2RV5EuWBH/axK6v4oaMi24H28wtyfvSeU8c89767blWFSk235gH31AdhrXRel4dCbunvm8hg7wyFVnOXrsfp4ll96m4tNxc01kY8/BAS3R8LPiyLEL46haugcT/TeyH0T19bSV5kyVrjJevJqvpsEUXwEtoJ0wCijPRjs70tD/0BScdeHZVyBrRGbOsMZonVBCx2o17R7DBubSZpmUZXeoiRXm+Mz3MYz5m6YLWp+WkeUeSRrMo/8Um7cXb+MObA05sIXtoRYmPH/Jviux5ihlBDQyWesSC3ZBANE2sxF71y3M6VTr1fPjBKZdiiR+Aqg68qDa60/OrUFjDHjz2vnCYoA==\\", \\"IV\\": \\"e7m3aiZdDXfquoJaa+a76A==\\", \\"ALG\\": 0}", "digest": "c5f0276a14ad92137f62bea1d93c23d65c956171fb7be0094edfce65c60d5933", "alg": "HMAC_SHA2"}'
location.service.agent  simulator, send encrypted message: plaintext is:
 {'authTier2r': b'Y-\x84\x18\x14\xe6\x96\x8d\xe1(Tq)U\xbd:~\xcb\xb2u\x16\xed\x1d\xff\xbf\xd6\x87\x1f\x06\xf9K\x9f', 'minimumFactorScore': 14, 'authTier2rSignature': b'\x08mq\xe9\x9dT\x98\xaf\x0c\\\xa1\xdb5G(j\x03\x8d7t)\x88_\x00@\x95\xfa\x16\x13\xaf|\x91f~\x1f\xaa\xe6\xadj;\x8c#\x90\x80\x1f\xfe\x94\x8dt;\x1c\x0f\xea\x82\x8cu\xa0\xcdH\xf8}ac\x89\xde\n\xaf\xd4\x95w1\x8ep\xa2\r\xe0b\xa9\x14/F5\xd9X\xaf\xa3w\xee\x15\x1bRi`\xb60\xc1\xd9\xcbd\x03\xf6u\x15\xa1\xea$\xc8\xff\xa5\x1av\x1f\x9a<\xcf-9)D\x9e\xe4\x1cJ\xc6\n\x07+\xd3\xf8\xba/\xbe\xb88#\xc373\xf9\x10Y\x1e\x04+[\xfdK.Y\xd9C\xd5\x12\xef\x1e\xa8P3(Ir\xd5\xb8:y\xe6\xc40/glB\x8bI\xebo\xf5\x9d\x88^\xa8w+\x8c\x18>\xbb\xf7\xf7\xe1\xe1\xf7\xd9\xf7\xdfK\xc1\xa9\x10\xba3\x02\x141\x80\x1b\x8a\x90z\x8ac\'\x82\x97\xc4G\x89"\x19xVE\xc9\x86\xbddG\x91\x1d\xf2j\x9c.P\xde\x02p&\xc15r\xcf\\y\x14\x16\xf6.\xb2\xbe/\xce\xdb\x06N\xef\xa3\xc0\x16;;\xa8\xa7V\xd0\x8aDp\xf3\x14V\xc9\x97\x91\xb5g\xaf:\x13-\\w\x8d\x9b\x1b\x10\xbba\n\xdf\x98\xf7\x983\xa4\xb7\xb4G\x9dL\xbd\xfa\xd7\xa9\xe9=\xff\xd8\xab0\xcay\x03\xf29z\xa5\x1a\xf0\xd9\x1d\xb3+\xbe3y\xdb)\x8d\x06\xaa\x9e\xb0\xef\xb5i]B~\xf6\xd0\x01M\xe7\x846\x16[}Z>t\xd49\xb6\xe3\xab}\x0f\xbd,@A\x94\xa3\xaf\x08\xec\xdev\x18\x9f5D\xf3\xdb\xabP\xbc\xec\xc0\xb4M\x80', 'currentFactorScore': 2, 'idr': {'service': 'LOCAUTH Service', 'uuid': '10caa7h0-5e12-71ce-010c-a7hebeac0140'}, 'locationServiceCertificate': '-----BEGIN CERTIFICATE-----\nMIIEhTCCAu0CAgN4MA0GCSqGSIb3DQEBCwUAMIGHMQswCQYDVQQGEwJVUzERMA8G\nA1UECAwIRGVsYXdhcmUxDzANBgNVBAcMBk5ld2FyazEbMBkGA1UECgwSUHJpc3Rp\nbmVUZWNoTG9ja2VyMRswGQYDVQQLDBJQcmlzdGluZVRlY2hMb2NrZXIxGjAYBgNV\nBAMMEWxvdGhhbC12aXJ0dWFsYm94MB4XDTE3MDYxMzIwMDE0M1oXDTE4MDYxMzIw\nMDE0M1owgYcxCzAJBgNVBAYTAlVTMREwDwYDVQQIDAhEZWxhd2FyZTEPMA0GA1UE\nBwwGTmV3YXJrMRswGQYDVQQKDBJQcmlzdGluZVRlY2hMb2NrZXIxGzAZBgNVBAsM\nElByaXN0aW5lVGVjaExvY2tlcjEaMBgGA1UEAwwRbG90aGFsLXZpcnR1YWxib3gw\nggGiMA0GCSqGSIb3DQEBAQUAA4IBjwAwggGKAoIBgQDXZ5TswNp0UFPPbalnSqKt\nG+UgvEa7N65Gs7CFJSYhz/8LtoZNuUaUZXU681vWimqcV8IU5fg8AXiWoTzZsJA+\nYvKm1Ozr4hfcXVJ03J8T2eV3HmCE8n8obYLB+dbnBIa+yM6FxtnJreJx12q7SEHG\npG2XlX2npHvbE++69864x18JEk2hG1Xc1TIsmhER4KLj99wiQQhhVlqqvjS44/pZ\nqY4dVx0LOKVie8aOoPp8jkU4ZT4pAiTiUIE7u+JpuyxB6aFO8cEVFIgRyvWiH/QR\nCulxRQRVxCfCoT0GUtDcy5bc4s8qoLJJBrq7peLHzyjhvG+3Md9nzsuHPzuvKpyQ\nrtZ0p11PtSUJ9se6mUaoej9BFXmYgiMWkbZxqLXLWjN3rCiDzVufgkBO7UKPmBzv\nbD5QmDoQBLGbZFIrvJLKUT07cePYscAH4wxYTurKX3hRenOjuJSthFkABUoesRG4\nF/HyN6g0iST6seNtjsA9UZEeMtO38TWWJ90idyW+lw8CAwEAATANBgkqhkiG9w0B\nAQsFAAOCAYEAb4vr2CknyMtT7XFvVq32adLn4biU2lR8JPrEsWsmjRA37EL33AON\n8EInUPHTm2TdeNXazEyxPjJPi4CVfx/tOoENKM5ine1P2+7nDtMI/P1CsJQvPKpc\nazZdF7i6I4+1vIDfx1c+gp03U4fCCwNpt2fAda5u4IoLp8GVGQxBihXM62CvY3rz\nFGVWljhrpePIWrTRR+5Y00IlYmTUGGE3P+mOyE3G0kf79rOKNh7eKdvvBWe1jJdC\nrcNfru0VAlhwD0cJnWf5+CvKfzJU12OjxPQiu74Lx0+EAU7wwsekvM9XdUJetar2\n/I/XO4oMoIDO51THMVbom+kMpfi3Hx5Lb0LzFYPjOJGgs+AOWXlj+ajmwT/D4H7n\nxrljb88TO9brCx2dKUJ8Na2U4eRFPXB+Zdiux8HBwskWRQNRcFuTrIAcpYsBmEIv\npCExcSrn/5RNniw/d09a4vbBH8YUlhU7RnGH6cfq0wUDA0GeuyHiltRMDBbSXUHx\nJ/QsK3Jyxu5o\n-----END CERTIFICATE-----\n'}
user.agent : receiveEncryptedMessage dict:
location.service.agent  simulator, send encrypted raw message:
 {'authTier2r': b'Y-\x84\x18\x14\xe6\x96\x8d\xe1(Tq)U\xbd:~\xcb\xb2u\x16\xed\x1d\xff\xbf\xd6\x87\x1f\x06\xf9K\x9f', 'minimumFactorScore': 14, 'header': {'spir': b'(Y_(vh\n\x05', 'spii': b'h%B\xc3\x8fI\x9av', 'length': 3574, 'sender': False, 'counter': 4, 'exchange_type': b'2', 'message_type': False}, 'authTier2rSignature': b'\x08mq\xe9\x9dT\x98\xaf\x0c\\\xa1\xdb5G(j\x03\x8d7t)\x88_\x00@\x95\xfa\x16\x13\xaf|\x91f~\x1f\xaa\xe6\xadj;\x8c#\x90\x80\x1f\xfe\x94\x8dt;\x1c\x0f\xea\x82\x8cu\xa0\xcdH\xf8}ac\x89\xde\n\xaf\xd4\x95w1\x8ep\xa2\r\xe0b\xa9\x14/F5\xd9X\xaf\xa3w\xee\x15\x1bRi`\xb60\xc1\xd9\xcbd\x03\xf6u\x15\xa1\xea$\xc8\xff\xa5\x1av\x1f\x9a<\xcf-9)D\x9e\xe4\x1cJ\xc6\n\x07+\xd3\xf8\xba/\xbe\xb88#\xc373\xf9\x10Y\x1e\x04+[\xfdK.Y\xd9C\xd5\x12\xef\x1e\xa8P3(Ir\xd5\xb8:y\xe6\xc40/glB\x8bI\xebo\xf5\x9d\x88^\xa8w+\x8c\x18>\xbb\xf7\xf7\xe1\xe1\xf7\xd9\xf7\xdfK\xc1\xa9\x10\xba3\x02\x141\x80\x1b\x8a\x90z\x8ac\'\x82\x97\xc4G\x89"\x19xVE\xc9\x86\xbddG\x91\x1d\xf2j\x9c.P\xde\x02p&\xc15r\xcf\\y\x14\x16\xf6.\xb2\xbe/\xce\xdb\x06N\xef\xa3\xc0\x16;;\xa8\xa7V\xd0\x8aDp\xf3\x14V\xc9\x97\x91\xb5g\xaf:\x13-\\w\x8d\x9b\x1b\x10\xbba\n\xdf\x98\xf7\x983\xa4\xb7\xb4G\x9dL\xbd\xfa\xd7\xa9\xe9=\xff\xd8\xab0\xcay\x03\xf29z\xa5\x1a\xf0\xd9\x1d\xb3+\xbe3y\xdb)\x8d\x06\xaa\x9e\xb0\xef\xb5i]B~\xf6\xd0\x01M\xe7\x846\x16[}Z>t\xd49\xb6\xe3\xab}\x0f\xbd,@A\x94\xa3\xaf\x08\xec\xdev\x18\x9f5D\xf3\xdb\xabP\xbc\xec\xc0\xb4M\x80', 'currentFactorScore': 2, 'idr': {'service': 'LOCAUTH Service', 'uuid': '10caa7h0-5e12-71ce-010c-a7hebeac0140'}, 'rawMessage': b'\x00\x00\r\xf6h%B\xc3\x8fI\x9av(Y_(vh\n\x05\x002\x00\x00\x00\x00\x00\x04{"msg": "{\\"MODE\\": 2, \\"CipherText\\": \\"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\\", \\"IV\\": \\"oFJ+QYvpBT/n8Il9aUkEsQ==\\", \\"ALG\\": 0}", "digest": "ebde1d373e757bc758a189b383da34ed61b5b78b81d1ae4be08c2edde1d9aed7", "alg": "HMAC_SHA2"}', 'locationServiceCertificate': '-----BEGIN CERTIFICATE-----\nMIIEhTCCAu0CAgN4MA0GCSqGSIb3DQEBCwUAMIGHMQswCQYDVQQGEwJVUzERMA8G\nA1UECAwIRGVsYXdhcmUxDzANBgNVBAcMBk5ld2FyazEbMBkGA1UECgwSUHJpc3Rp\nbmVUZWNoTG9ja2VyMRswGQYDVQQLDBJQcmlzdGluZVRlY2hMb2NrZXIxGjAYBgNV\nBAMMEWxvdGhhbC12aXJ0dWFsYm94MB4XDTE3MDYxMzIwMDE0M1oXDTE4MDYxMzIw\nMDE0M1owgYcxCzAJBgNVBAYTAlVTMREwDwYDVQQIDAhEZWxhd2FyZTEPMA0GA1UE\nBwwGTmV3YXJrMRswGQYDVQQKDBJQcmlzdGluZVRlY2hMb2NrZXIxGzAZBgNVBAsM\nElByaXN0aW5lVGVjaExvY2tlcjEaMBgGA1UEAwwRbG90aGFsLXZpcnR1YWxib3gw\nggGiMA0GCSqGSIb3DQEBAQUAA4IBjwAwggGKAoIBgQDXZ5TswNp0UFPPbalnSqKt\nG+UgvEa7N65Gs7CFJSYhz/8LtoZNuUaUZXU681vWimqcV8IU5fg8AXiWoTzZsJA+\nYvKm1Ozr4hfcXVJ03J8T2eV3HmCE8n8obYLB+dbnBIa+yM6FxtnJreJx12q7SEHG\npG2XlX2npHvbE++69864x18JEk2hG1Xc1TIsmhER4KLj99wiQQhhVlqqvjS44/pZ\nqY4dVx0LOKVie8aOoPp8jkU4ZT4pAiTiUIE7u+JpuyxB6aFO8cEVFIgRyvWiH/QR\nCulxRQRVxCfCoT0GUtDcy5bc4s8qoLJJBrq7peLHzyjhvG+3Md9nzsuHPzuvKpyQ\nrtZ0p11PtSUJ9se6mUaoej9BFXmYgiMWkbZxqLXLWjN3rCiDzVufgkBO7UKPmBzv\nbD5QmDoQBLGbZFIrvJLKUT07cePYscAH4wxYTurKX3hRenOjuJSthFkABUoesRG4\nF/HyN6g0iST6seNtjsA9UZEeMtO38TWWJ90idyW+lw8CAwEAATANBgkqhkiG9w0B\nAQsFAAOCAYEAb4vr2CknyMtT7XFvVq32adLn4biU2lR8JPrEsWsmjRA37EL33AON\n8EInUPHTm2TdeNXazEyxPjJPi4CVfx/tOoENKM5ine1P2+7nDtMI/P1CsJQvPKpc\nazZdF7i6I4+1vIDfx1c+gp03U4fCCwNpt2fAda5u4IoLp8GVGQxBihXM62CvY3rz\nFGVWljhrpePIWrTRR+5Y00IlYmTUGGE3P+mOyE3G0kf79rOKNh7eKdvvBWe1jJdC\nrcNfru0VAlhwD0cJnWf5+CvKfzJU12OjxPQiu74Lx0+EAU7wwsekvM9XdUJetar2\n/I/XO4oMoIDO51THMVbom+kMpfi3Hx5Lb0LzFYPjOJGgs+AOWXlj+ajmwT/D4H7n\nxrljb88TO9brCx2dKUJ8Na2U4eRFPXB+Zdiux8HBwskWRQNRcFuTrIAcpYsBmEIv\npCExcSrn/5RNniw/d09a4vbBH8YUlhU7RnGH6cfq0wUDA0GeuyHiltRMDBbSXUHx\nJ/QsK3Jyxu5o\n-----END CERTIFICATE-----\n'}
 b'\x00\x00\r\xf6h%B\xc3\x8fI\x9av(Y_(vh\n\x05\x002\x00\x00\x00\x00\x00\x04{"msg": "{\\"MODE\\": 2, \\"CipherText\\": \\"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\\", \\"IV\\": \\"oFJ+QYvpBT/n8Il9aUkEsQ==\\", \\"ALG\\": 0}", "digest": "ebde1d373e757bc758a189b383da34ed61b5b78b81d1ae4be08c2edde1d9aed7", "alg": "HMAC_SHA2"}'
User agent: authTier2rLocal (expected):
 b'Y-\x84\x18\x14\xe6\x96\x8d\xe1(Tq)U\xbd:~\xcb\xb2u\x16\xed\x1d\xff\xbf\xd6\x87\x1f\x06\xf9K\x9f'
User agent: authTier2rReceived:
 b'Y-\x84\x18\x14\xe6\x96\x8d\xe1(Tq)U\xbd:~\xcb\xb2u\x16\xed\x1d\xff\xbf\xd6\x87\x1f\x06\xf9K\x9f'
User agent: valid AUTH_TIER2r signature
Location Server: processing state:  State.TIER2_PRIVACY_AUTHENTICATION_ADDITIONAL_AUTHENTICATION_FACTORS
User agent: processing state:  State.TIER2_PRIVACY_AUTHENTICATION_ADDITIONAL_AUTHENTICATION_FACTORS
user.agent  simulator, send encrypted message: plaintext is:
 {'enonce': '{"MODE": 2, "CipherText": "lMc97aa3tjxprVHFy0mrta/Y6f5z0SOM6mgRw1EtZi5NkuU9U/jC0zlO8VXEY3D4", "IV": "Szc5TPdGFHF0Gw2avDIllQ==", "ALG": 0}', 'authenticationKeyType': 'Shared Key'}
location.service.agent : receiveEncryptedMessage dict:
user.agent  simulator, send encrypted raw message:
 {'enonce': '{"MODE": 2, "CipherText": "lMc97aa3tjxprVHFy0mrta/Y6f5z0SOM6mgRw1EtZi5NkuU9U/jC0zlO8VXEY3D4", "IV": "Szc5TPdGFHF0Gw2avDIllQ==", "ALG": 0}', 'rawMessage': b'\x00\x00\x01\xf6h%B\xc3\x8fI\x9av(Y_(vh\n\x05(2\x00\x00\x00\x00\x00\x03{"msg": "{\\"MODE\\": 2, \\"CipherText\\": \\"IjND54PL/kJgK2GzicnyVzNVbX6v51eQM/bKVOIYxLwnj6Ss1F86NN+V24DXOz7S3uoiIVSNq01d2Ql8MyQzdHRw9J6aZL7RzOjeEzd3tCYXGoVUPH+yeSP/hitq/rqHMPrS0Z2ou/Eve06GdpIA4m5aWgCNGKVXWaxMBuxqDtLLxr5eOD9cuZ0MMMYB2B6nkdKp+jvtsw3kVwLI5rDHwgJ4LBP/kIosSy6e/dio57hPiA2RBgZqCMPFeUl9pQWZWv1I/r1b9txuOEJC15HJEQ==\\", \\"IV\\": \\"CWsxbwoCbFiCmG7QqWU4yA==\\", \\"ALG\\": 0}", "digest": "4b2015abc8f485a8d2c922a6c95b14c638d1c6d9ec4360725660022d66ae3cbe", "alg": "HMAC_SHA2"}', 'header': {'spir': b'(Y_(vh\n\x05', 'spii': b'h%B\xc3\x8fI\x9av', 'length': 502, 'sender': True, 'counter': 3, 'exchange_type': b'2', 'message_type': True}, 'authenticationKeyType': 'Shared Key'}
 b'\x00\x00\x01\xf6h%B\xc3\x8fI\x9av(Y_(vh\n\x05(2\x00\x00\x00\x00\x00\x03{"msg": "{\\"MODE\\": 2, \\"CipherText\\": \\"IjND54PL/kJgK2GzicnyVzNVbX6v51eQM/bKVOIYxLwnj6Ss1F86NN+V24DXOz7S3uoiIVSNq01d2Ql8MyQzdHRw9J6aZL7RzOjeEzd3tCYXGoVUPH+yeSP/hitq/rqHMPrS0Z2ou/Eve06GdpIA4m5aWgCNGKVXWaxMBuxqDtLLxr5eOD9cuZ0MMMYB2B6nkdKp+jvtsw3kVwLI5rDHwgJ4LBP/kIosSy6e/dio57hPiA2RBgZqCMPFeUl9pQWZWv1I/r1b9txuOEJC15HJEQ==\\", \\"IV\\": \\"CWsxbwoCbFiCmG7QqWU4yA==\\", \\"ALG\\": 0}", "digest": "4b2015abc8f485a8d2c922a6c95b14c638d1c6d9ec4360725660022d66ae3cbe", "alg": "HMAC_SHA2"}'
User agent: ENONCE, keyType:
 b'\x00\x00\x01\xf6h%B\xc3\x8fI\x9av(Y_(vh\n\x05(2\x00\x00\x00\x00\x00\x03{"msg": "{\\"MODE\\": 2, \\"CipherText\\": \\"IjND54PL/kJgK2GzicnyVzNVbX6v51eQM/bKVOIYxLwnj6Ss1F86NN+V24DXOz7S3uoiIVSNq01d2Ql8MyQzdHRw9J6aZL7RzOjeEzd3tCYXGoVUPH+yeSP/hitq/rqHMPrS0Z2ou/Eve06GdpIA4m5aWgCNGKVXWaxMBuxqDtLLxr5eOD9cuZ0MMMYB2B6nkdKp+jvtsw3kVwLI5rDHwgJ4LBP/kIosSy6e/dio57hPiA2RBgZqCMPFeUl9pQWZWv1I/r1b9txuOEJC15HJEQ==\\", \\"IV\\": \\"CWsxbwoCbFiCmG7QqWU4yA==\\", \\"ALG\\": 0}", "digest": "4b2015abc8f485a8d2c922a6c95b14c638d1c6d9ec4360725660022d66ae3cbe", "alg": "HMAC_SHA2"}'
location.service.agent  simulator, send encrypted message: plaintext is:
 {'minimumFactorScore': 14, 'currentFactorScore': 5}
user.agent : receiveEncryptedMessage dict:
location.service.agent  simulator, send encrypted raw message:
 {'minimumFactorScore': 14, 'header': {'spir': b'(Y_(vh\n\x05', 'spii': b'h%B\xc3\x8fI\x9av', 'length': 310, 'sender': False, 'counter': 5, 'exchange_type': b'2', 'message_type': False}, 'rawMessage': b'\x00\x00\x016h%B\xc3\x8fI\x9av(Y_(vh\n\x05\x002\x00\x00\x00\x00\x00\x05{"msg": "{\\"MODE\\": 2, \\"CipherText\\": \\"R9DfgXd9MZVK8lvQ+ClOo5QkLLcshE3+g6LxJ6DDKnAFcc7ai5cYx4Lw/ju+Dc14YGytEuvjqF3n4bzstSbh2Q==\\", \\"IV\\": \\"lPcrbtPpGjSIOh2FtseSOw==\\", \\"ALG\\": 0}", "digest": "c92f8e93be3346671d42aeb25275901541409ebc7a846a3cf9410d6010b1f317", "alg": "HMAC_SHA2"}', 'currentFactorScore': 5}
 b'\x00\x00\x016h%B\xc3\x8fI\x9av(Y_(vh\n\x05\x002\x00\x00\x00\x00\x00\x05{"msg": "{\\"MODE\\": 2, \\"CipherText\\": \\"R9DfgXd9MZVK8lvQ+ClOo5QkLLcshE3+g6LxJ6DDKnAFcc7ai5cYx4Lw/ju+Dc14YGytEuvjqF3n4bzstSbh2Q==\\", \\"IV\\": \\"lPcrbtPpGjSIOh2FtseSOw==\\", \\"ALG\\": 0}", "digest": "c92f8e93be3346671d42aeb25275901541409ebc7a846a3cf9410d6010b1f317", "alg": "HMAC_SHA2"}'
User agent: processing state:  State.TIER2_PRIVACY_AUTHENTICATION_ADDITIONAL_AUTHENTICATION_FACTORS
Location Server: processing state:  State.TIER2_PRIVACY_AUTHENTICATION_ADDITIONAL_AUTHENTICATION_FACTORS
user.agent  simulator, send encrypted message: plaintext is:
 {'enonce': '{"MODE": 2, "CipherText": "Ons0U9us06yKWkun3xc3G6vtHReoKdBaQ/TFDmoFrmvhscQQG/0wp//exQ9P0jJ0", "IV": "0ZMgGqNhYgfJJHyMc1GKXw==", "ALG": 0}', 'authenticationKeyType': 'Fingerprint'}
location.service.agent : receiveEncryptedMessage dict:
user.agent  simulator, send encrypted raw message:
 {'enonce': '{"MODE": 2, "CipherText": "Ons0U9us06yKWkun3xc3G6vtHReoKdBaQ/TFDmoFrmvhscQQG/0wp//exQ9P0jJ0", "IV": "0ZMgGqNhYgfJJHyMc1GKXw==", "ALG": 0}', 'rawMessage': b'\x00\x00\x01\xf6h%B\xc3\x8fI\x9av(Y_(vh\n\x05(2\x00\x00\x00\x00\x00\x04{"msg": "{\\"MODE\\": 2, \\"CipherText\\": \\"ZxW08uBLhg9T0noSfY4myB3OHRfB1iu3LdWVZ2gMokMQsacB46n6YL5H1p3fe1SL8+G4zu4GmwDn/SxndCgU9EZF67XYHl0WPH0X9dCoFkFqZPlOWMQjcRskVveDLB2BYqEcxtdKi+/fuDD1SeIZyTiNLWoy1TPBHBf0eA3LjQpimKxUxZzj9lx1dFcHKwTs6nsfnQaOrl9/YHAT15A6rmHRCljOHq3LcmOSN9baRlLTxIfK4rjrxTYgnJgmoqvAqGct0zSqmdDB9gGGYavZ0g==\\", \\"IV\\": \\"Uu95+qXDrv2PgwXEUnkQ2A==\\", \\"ALG\\": 0}", "digest": "18043d1bb225c8ae4b800d1b69831fd2fe0eec428504e6c75faa09c731195272", "alg": "HMAC_SHA2"}', 'header': {'spir': b'(Y_(vh\n\x05', 'spii': b'h%B\xc3\x8fI\x9av', 'length': 502, 'sender': True, 'counter': 4, 'exchange_type': b'2', 'message_type': True}, 'authenticationKeyType': 'Fingerprint'}
 b'\x00\x00\x01\xf6h%B\xc3\x8fI\x9av(Y_(vh\n\x05(2\x00\x00\x00\x00\x00\x04{"msg": "{\\"MODE\\": 2, \\"CipherText\\": \\"ZxW08uBLhg9T0noSfY4myB3OHRfB1iu3LdWVZ2gMokMQsacB46n6YL5H1p3fe1SL8+G4zu4GmwDn/SxndCgU9EZF67XYHl0WPH0X9dCoFkFqZPlOWMQjcRskVveDLB2BYqEcxtdKi+/fuDD1SeIZyTiNLWoy1TPBHBf0eA3LjQpimKxUxZzj9lx1dFcHKwTs6nsfnQaOrl9/YHAT15A6rmHRCljOHq3LcmOSN9baRlLTxIfK4rjrxTYgnJgmoqvAqGct0zSqmdDB9gGGYavZ0g==\\", \\"IV\\": \\"Uu95+qXDrv2PgwXEUnkQ2A==\\", \\"ALG\\": 0}", "digest": "18043d1bb225c8ae4b800d1b69831fd2fe0eec428504e6c75faa09c731195272", "alg": "HMAC_SHA2"}'
User agent: ENONCE, keyType:
 b'\x00\x00\x01\xf6h%B\xc3\x8fI\x9av(Y_(vh\n\x05(2\x00\x00\x00\x00\x00\x04{"msg": "{\\"MODE\\": 2, \\"CipherText\\": \\"ZxW08uBLhg9T0noSfY4myB3OHRfB1iu3LdWVZ2gMokMQsacB46n6YL5H1p3fe1SL8+G4zu4GmwDn/SxndCgU9EZF67XYHl0WPH0X9dCoFkFqZPlOWMQjcRskVveDLB2BYqEcxtdKi+/fuDD1SeIZyTiNLWoy1TPBHBf0eA3LjQpimKxUxZzj9lx1dFcHKwTs6nsfnQaOrl9/YHAT15A6rmHRCljOHq3LcmOSN9baRlLTxIfK4rjrxTYgnJgmoqvAqGct0zSqmdDB9gGGYavZ0g==\\", \\"IV\\": \\"Uu95+qXDrv2PgwXEUnkQ2A==\\", \\"ALG\\": 0}", "digest": "18043d1bb225c8ae4b800d1b69831fd2fe0eec428504e6c75faa09c731195272", "alg": "HMAC_SHA2"}'
location.service.agent  simulator, send encrypted message: plaintext is:
 {'minimumFactorScore': 14, 'currentFactorScore': 8}
user.agent : receiveEncryptedMessage dict:
location.service.agent  simulator, send encrypted raw message:
 {'minimumFactorScore': 14, 'header': {'spir': b'(Y_(vh\n\x05', 'spii': b'h%B\xc3\x8fI\x9av', 'length': 310, 'sender': False, 'counter': 6, 'exchange_type': b'2', 'message_type': False}, 'rawMessage': b'\x00\x00\x016h%B\xc3\x8fI\x9av(Y_(vh\n\x05\x002\x00\x00\x00\x00\x00\x06{"msg": "{\\"MODE\\": 2, \\"CipherText\\": \\"aGBA9U5k1JPiPoL4IENkpzmZGpcGQ41wNEGEIx4arvVniY3TD1/ItXdSy030g+SFoE8GWPW+uIYDzzlQuXJIFQ==\\", \\"IV\\": \\"ud0UQ8SQHWtfRyEOeo57ZQ==\\", \\"ALG\\": 0}", "digest": "2ecd1b98fab05bf737f38668cb936d5efd431fadfde2a8d590e54d9a41b0c7d4", "alg": "HMAC_SHA2"}', 'currentFactorScore': 8}
 b'\x00\x00\x016h%B\xc3\x8fI\x9av(Y_(vh\n\x05\x002\x00\x00\x00\x00\x00\x06{"msg": "{\\"MODE\\": 2, \\"CipherText\\": \\"aGBA9U5k1JPiPoL4IENkpzmZGpcGQ41wNEGEIx4arvVniY3TD1/ItXdSy030g+SFoE8GWPW+uIYDzzlQuXJIFQ==\\", \\"IV\\": \\"ud0UQ8SQHWtfRyEOeo57ZQ==\\", \\"ALG\\": 0}", "digest": "2ecd1b98fab05bf737f38668cb936d5efd431fadfde2a8d590e54d9a41b0c7d4", "alg": "HMAC_SHA2"}'
User agent: processing state:  State.TIER2_PRIVACY_AUTHENTICATION_ADDITIONAL_AUTHENTICATION_FACTORS
Location Server: processing state:  State.TIER2_PRIVACY_AUTHENTICATION_ADDITIONAL_AUTHENTICATION_FACTORS
user.agent  simulator, send encrypted message: plaintext is:
 {'enonce': '{"MODE": 2, "CipherText": "AHow63YJiB+3n+rUiqFLsp7blRCy4O7bH5gvKQAf8qBoPpT1Ovzj0DiVFX6raenp", "IV": "6LYeOj2f3ypIHnCSx12QtA==", "ALG": 0}', 'authenticationKeyType': 'PIN'}
location.service.agent : receiveEncryptedMessage dict:
user.agent  simulator, send encrypted raw message:
 {'enonce': '{"MODE": 2, "CipherText": "AHow63YJiB+3n+rUiqFLsp7blRCy4O7bH5gvKQAf8qBoPpT1Ovzj0DiVFX6raenp", "IV": "6LYeOj2f3ypIHnCSx12QtA==", "ALG": 0}', 'rawMessage': b'\x00\x00\x01\xf6h%B\xc3\x8fI\x9av(Y_(vh\n\x05(2\x00\x00\x00\x00\x00\x05{"msg": "{\\"MODE\\": 2, \\"CipherText\\": \\"91Th5dW+fnnMomcyU8KHkyngMw5//Onhd8K1wa8r+LENftqVIKbjvUqeM8qPl07dbWpRdRmS4OTFN9RwpJZc3/XwJ5gNx7gVU1lFat/C3REyIpv2ofnpkMFluIDdirBk4z13mBx1ZFZZyZz7JbroCCyOgpSZP4c5kUGavmz89HFGKY38fPhxWusrY7zDSE5a0yOY+aPqneNzmH4RmWNLXl0XzMCH6MyuX+lOYenAeGYO5ATJocJaWnoyt03DGbErP+uQ/riLdytT3jN0vUJVLg==\\", \\"IV\\": \\"brnfUQX7wUOTgAasZKx6hQ==\\", \\"ALG\\": 0}", "digest": "d87c51a14fad13adfd286ce6b61079f8c52e3c08254b54928e7446d3549c985c", "alg": "HMAC_SHA2"}', 'header': {'spir': b'(Y_(vh\n\x05', 'spii': b'h%B\xc3\x8fI\x9av', 'length': 502, 'sender': True, 'counter': 5, 'exchange_type': b'2', 'message_type': True}, 'authenticationKeyType': 'PIN'}
 b'\x00\x00\x01\xf6h%B\xc3\x8fI\x9av(Y_(vh\n\x05(2\x00\x00\x00\x00\x00\x05{"msg": "{\\"MODE\\": 2, \\"CipherText\\": \\"91Th5dW+fnnMomcyU8KHkyngMw5//Onhd8K1wa8r+LENftqVIKbjvUqeM8qPl07dbWpRdRmS4OTFN9RwpJZc3/XwJ5gNx7gVU1lFat/C3REyIpv2ofnpkMFluIDdirBk4z13mBx1ZFZZyZz7JbroCCyOgpSZP4c5kUGavmz89HFGKY38fPhxWusrY7zDSE5a0yOY+aPqneNzmH4RmWNLXl0XzMCH6MyuX+lOYenAeGYO5ATJocJaWnoyt03DGbErP+uQ/riLdytT3jN0vUJVLg==\\", \\"IV\\": \\"brnfUQX7wUOTgAasZKx6hQ==\\", \\"ALG\\": 0}", "digest": "d87c51a14fad13adfd286ce6b61079f8c52e3c08254b54928e7446d3549c985c", "alg": "HMAC_SHA2"}'
User agent: ENONCE, keyType:
 b'\x00\x00\x01\xf6h%B\xc3\x8fI\x9av(Y_(vh\n\x05(2\x00\x00\x00\x00\x00\x05{"msg": "{\\"MODE\\": 2, \\"CipherText\\": \\"91Th5dW+fnnMomcyU8KHkyngMw5//Onhd8K1wa8r+LENftqVIKbjvUqeM8qPl07dbWpRdRmS4OTFN9RwpJZc3/XwJ5gNx7gVU1lFat/C3REyIpv2ofnpkMFluIDdirBk4z13mBx1ZFZZyZz7JbroCCyOgpSZP4c5kUGavmz89HFGKY38fPhxWusrY7zDSE5a0yOY+aPqneNzmH4RmWNLXl0XzMCH6MyuX+lOYenAeGYO5ATJocJaWnoyt03DGbErP+uQ/riLdytT3jN0vUJVLg==\\", \\"IV\\": \\"brnfUQX7wUOTgAasZKx6hQ==\\", \\"ALG\\": 0}", "digest": "d87c51a14fad13adfd286ce6b61079f8c52e3c08254b54928e7446d3549c985c", "alg": "HMAC_SHA2"}'
location.service.agent  simulator, send encrypted message: plaintext is:
 {'minimumFactorScore': 14, 'currentFactorScore': 9}
user.agent : receiveEncryptedMessage dict:
 {'minimumFactorScore': 14, 'header': {'spir': b'(Y_(vh\n\x05', 'spii': b'h%B\xc3\x8fI\x9av', 'length': 310, 'sender': False, 'counter': 7, 'exchange_type': b'2', 'message_type': False}, 'rawMessage': b'\x00\x00\x016h%B\xc3\x8fI\x9av(Y_(vh\n\x05\x002\x00\x00\x00\x00\x00\x07{"msg": "{\\"MODE\\": 2, \\"CipherText\\": \\"yVkQnfnik4FCEOBYB6it1GGtNdX/L2c7NWQbU8WaHPmnVkDQfwK0YZuxszImEsH+n7uchF5PIZUEUqRoy3AAmA==\\", \\"IV\\": \\"Sn+U3TAzk3gZ4ew4bGscag==\\", \\"ALG\\": 0}", "digest": "42a7488de839161e852818e6cc8992a5bd6fe2d018b93d3eefd49aac45721dd4", "alg": "HMAC_SHA2"}', 'currentFactorScore': 9}
location.service.agent  simulator, send encrypted raw message:
 b'\x00\x00\x016h%B\xc3\x8fI\x9av(Y_(vh\n\x05\x002\x00\x00\x00\x00\x00\x07{"msg": "{\\"MODE\\": 2, \\"CipherText\\": \\"yVkQnfnik4FCEOBYB6it1GGtNdX/L2c7NWQbU8WaHPmnVkDQfwK0YZuxszImEsH+n7uchF5PIZUEUqRoy3AAmA==\\", \\"IV\\": \\"Sn+U3TAzk3gZ4ew4bGscag==\\", \\"ALG\\": 0}", "digest": "42a7488de839161e852818e6cc8992a5bd6fe2d018b93d3eefd49aac45721dd4", "alg": "HMAC_SHA2"}'
User agent: processing state:  State.TIER2_PRIVACY_AUTHENTICATION_ADDITIONAL_AUTHENTICATION_FACTORS
Location Server: processing state:  State.TIER2_PRIVACY_AUTHENTICATION_ADDITIONAL_AUTHENTICATION_FACTORS
user.agent  simulator, send encrypted message: plaintext is:
 {'enonce': '{"MODE": 2, "CipherText": "wpiEIsEJsmPrWRPgj0heph5xH9tqvsggJEYvRTxa01dXxE6iqswVzYYynuOTtbTL", "IV": "LVdyyk5YiGvRdVKxsswZiw==", "ALG": 0}', 'authenticationKeyType': 'Pattern'}
location.service.agent : receiveEncryptedMessage dict:
user.agent  simulator, send encrypted raw message:
 {'enonce': '{"MODE": 2, "CipherText": "wpiEIsEJsmPrWRPgj0heph5xH9tqvsggJEYvRTxa01dXxE6iqswVzYYynuOTtbTL", "IV": "LVdyyk5YiGvRdVKxsswZiw==", "ALG": 0}', 'rawMessage': b'\x00\x00\x01\xf6h%B\xc3\x8fI\x9av(Y_(vh\n\x05(2\x00\x00\x00\x00\x00\x06{"msg": "{\\"MODE\\": 2, \\"CipherText\\": \\"Ugck+cOvwnvZkMIg/1Rq/lTqB4SDT8tWvslmaT/BfwaqgqMhE1ZuckHmR515vUIwc+Zqbrwd/sdjN5jcbV9EtgV6yg42gDRkdWS79ESgA5LYpp5aaxzGB2d9JzZOmOs4eg5zKCJuYAzjeDr1KQjUsctEu+lF/YbojWBaTHNtKLpH2yzsKj5CB/G7X+YEuGpc/6wTDAZ6HE42NKrFC5i9FqmnGygqptEGxh20FHXtyYFymfUVZCkf6HbGLhO+BynjsDQLKf+bB6cpXLIGtg/9ug==\\", \\"IV\\": \\"VCYFIveM6VJVE2iW8VCG+Q==\\", \\"ALG\\": 0}", "digest": "27c3cb36db707d6862f8df626140291cbb987a48231ee9bc6e3dffd715d88517", "alg": "HMAC_SHA2"}', 'header': {'spir': b'(Y_(vh\n\x05', 'spii': b'h%B\xc3\x8fI\x9av', 'length': 502, 'sender': True, 'counter': 6, 'exchange_type': b'2', 'message_type': True}, 'authenticationKeyType': 'Pattern'}
 b'\x00\x00\x01\xf6h%B\xc3\x8fI\x9av(Y_(vh\n\x05(2\x00\x00\x00\x00\x00\x06{"msg": "{\\"MODE\\": 2, \\"CipherText\\": \\"Ugck+cOvwnvZkMIg/1Rq/lTqB4SDT8tWvslmaT/BfwaqgqMhE1ZuckHmR515vUIwc+Zqbrwd/sdjN5jcbV9EtgV6yg42gDRkdWS79ESgA5LYpp5aaxzGB2d9JzZOmOs4eg5zKCJuYAzjeDr1KQjUsctEu+lF/YbojWBaTHNtKLpH2yzsKj5CB/G7X+YEuGpc/6wTDAZ6HE42NKrFC5i9FqmnGygqptEGxh20FHXtyYFymfUVZCkf6HbGLhO+BynjsDQLKf+bB6cpXLIGtg/9ug==\\", \\"IV\\": \\"VCYFIveM6VJVE2iW8VCG+Q==\\", \\"ALG\\": 0}", "digest": "27c3cb36db707d6862f8df626140291cbb987a48231ee9bc6e3dffd715d88517", "alg": "HMAC_SHA2"}'
User agent: ENONCE, keyType:
 b'\x00\x00\x01\xf6h%B\xc3\x8fI\x9av(Y_(vh\n\x05(2\x00\x00\x00\x00\x00\x06{"msg": "{\\"MODE\\": 2, \\"CipherText\\": \\"Ugck+cOvwnvZkMIg/1Rq/lTqB4SDT8tWvslmaT/BfwaqgqMhE1ZuckHmR515vUIwc+Zqbrwd/sdjN5jcbV9EtgV6yg42gDRkdWS79ESgA5LYpp5aaxzGB2d9JzZOmOs4eg5zKCJuYAzjeDr1KQjUsctEu+lF/YbojWBaTHNtKLpH2yzsKj5CB/G7X+YEuGpc/6wTDAZ6HE42NKrFC5i9FqmnGygqptEGxh20FHXtyYFymfUVZCkf6HbGLhO+BynjsDQLKf+bB6cpXLIGtg/9ug==\\", \\"IV\\": \\"VCYFIveM6VJVE2iW8VCG+Q==\\", \\"ALG\\": 0}", "digest": "27c3cb36db707d6862f8df626140291cbb987a48231ee9bc6e3dffd715d88517", "alg": "HMAC_SHA2"}'
location.service.agent  simulator, send encrypted message: plaintext is:
 {'minimumFactorScore': 14, 'currentFactorScore': 10}
user.agent : receiveEncryptedMessage dict:
location.service.agent  simulator, send encrypted raw message:
 {'minimumFactorScore': 14, 'header': {'spir': b'(Y_(vh\n\x05', 'spii': b'h%B\xc3\x8fI\x9av', 'length': 310, 'sender': False, 'counter': 8, 'exchange_type': b'2', 'message_type': False}, 'rawMessage': b'\x00\x00\x016h%B\xc3\x8fI\x9av(Y_(vh\n\x05\x002\x00\x00\x00\x00\x00\x08{"msg": "{\\"MODE\\": 2, \\"CipherText\\": \\"1ax7GBCCjSiHykn9xv6X2EBgvHySPe7Er1/Y7DnTMjSJ0qAYmLfiBt18jPf0Y0TqS2hOugTC3zIseB/Sp5F9FQ==\\", \\"IV\\": \\"cTs878wmUYcWEiCvFBnmPQ==\\", \\"ALG\\": 0}", "digest": "54d362c83c2691dfb76fbc75b2ef1e84b2b1e99de0584cec0c3db4add1a00e0f", "alg": "HMAC_SHA2"}', 'currentFactorScore': 10}
 b'\x00\x00\x016h%B\xc3\x8fI\x9av(Y_(vh\n\x05\x002\x00\x00\x00\x00\x00\x08{"msg": "{\\"MODE\\": 2, \\"CipherText\\": \\"1ax7GBCCjSiHykn9xv6X2EBgvHySPe7Er1/Y7DnTMjSJ0qAYmLfiBt18jPf0Y0TqS2hOugTC3zIseB/Sp5F9FQ==\\", \\"IV\\": \\"cTs878wmUYcWEiCvFBnmPQ==\\", \\"ALG\\": 0}", "digest": "54d362c83c2691dfb76fbc75b2ef1e84b2b1e99de0584cec0c3db4add1a00e0f", "alg": "HMAC_SHA2"}'
User agent: processing state:  State.TIER2_PRIVACY_AUTHENTICATION_ADDITIONAL_AUTHENTICATION_FACTORS
Location Server: processing state:  State.TIER2_PRIVACY_AUTHENTICATION_ADDITIONAL_AUTHENTICATION_FACTORS
user.agent  simulator, send encrypted message: plaintext is:
 {'enonce': '{"MODE": 2, "CipherText": "SA3DlfhDzpb8WAXJJSw5N5467x+hfukyq4RMd1PvPso/5ohh+j1kY5QkLiNfkgxX", "IV": "H1hHHaGIRNOgrFoJubPS+g==", "ALG": 0}', 'authenticationKeyType': 'Face'}
user.agent  simulator, send encrypted raw message:
location.service.agent : receiveEncryptedMessage dict:
 b'\x00\x00\x01\xf6h%B\xc3\x8fI\x9av(Y_(vh\n\x05(2\x00\x00\x00\x00\x00\x07{"msg": "{\\"MODE\\": 2, \\"CipherText\\": \\"mqvzoZC9YOJUhJh8cshBSFF9XOkF2vvqTwvhZuC8XKGcWw9SMh+3rqRsCm/joSry8v4HcO5Epm56qK3IIqpUkU/tLqsXg6XXWUy5BngIQE0klseK5tE+m5NG02fC2ml3URtNeu4mpE4u17YHgUBDYiUS8OM1CS6OGow5zCz0fWElpaS74vpZFq33xAxf8rlVZN5eo4sr1jOKdzkVCEtkv3yKnbRZBjqb1ergL+v5xx8vtV6xOwnlFfPtVGOk3g33YjpDWk89T21mqlPCvJbG7A==\\", \\"IV\\": \\"q9g6rNoqlyD3sb24oNkvPQ==\\", \\"ALG\\": 0}", "digest": "241f24ed911b74cac6bf0bd32495fc8936439b21ba3dd7533c2a327e5eac08aa", "alg": "HMAC_SHA2"}'
 {'enonce': '{"MODE": 2, "CipherText": "SA3DlfhDzpb8WAXJJSw5N5467x+hfukyq4RMd1PvPso/5ohh+j1kY5QkLiNfkgxX", "IV": "H1hHHaGIRNOgrFoJubPS+g==", "ALG": 0}', 'rawMessage': b'\x00\x00\x01\xf6h%B\xc3\x8fI\x9av(Y_(vh\n\x05(2\x00\x00\x00\x00\x00\x07{"msg": "{\\"MODE\\": 2, \\"CipherText\\": \\"mqvzoZC9YOJUhJh8cshBSFF9XOkF2vvqTwvhZuC8XKGcWw9SMh+3rqRsCm/joSry8v4HcO5Epm56qK3IIqpUkU/tLqsXg6XXWUy5BngIQE0klseK5tE+m5NG02fC2ml3URtNeu4mpE4u17YHgUBDYiUS8OM1CS6OGow5zCz0fWElpaS74vpZFq33xAxf8rlVZN5eo4sr1jOKdzkVCEtkv3yKnbRZBjqb1ergL+v5xx8vtV6xOwnlFfPtVGOk3g33YjpDWk89T21mqlPCvJbG7A==\\", \\"IV\\": \\"q9g6rNoqlyD3sb24oNkvPQ==\\", \\"ALG\\": 0}", "digest": "241f24ed911b74cac6bf0bd32495fc8936439b21ba3dd7533c2a327e5eac08aa", "alg": "HMAC_SHA2"}', 'header': {'spir': b'(Y_(vh\n\x05', 'spii': b'h%B\xc3\x8fI\x9av', 'length': 502, 'sender': True, 'counter': 7, 'exchange_type': b'2', 'message_type': True}, 'authenticationKeyType': 'Face'}
User agent: ENONCE, keyType:
 b'\x00\x00\x01\xf6h%B\xc3\x8fI\x9av(Y_(vh\n\x05(2\x00\x00\x00\x00\x00\x07{"msg": "{\\"MODE\\": 2, \\"CipherText\\": \\"mqvzoZC9YOJUhJh8cshBSFF9XOkF2vvqTwvhZuC8XKGcWw9SMh+3rqRsCm/joSry8v4HcO5Epm56qK3IIqpUkU/tLqsXg6XXWUy5BngIQE0klseK5tE+m5NG02fC2ml3URtNeu4mpE4u17YHgUBDYiUS8OM1CS6OGow5zCz0fWElpaS74vpZFq33xAxf8rlVZN5eo4sr1jOKdzkVCEtkv3yKnbRZBjqb1ergL+v5xx8vtV6xOwnlFfPtVGOk3g33YjpDWk89T21mqlPCvJbG7A==\\", \\"IV\\": \\"q9g6rNoqlyD3sb24oNkvPQ==\\", \\"ALG\\": 0}", "digest": "241f24ed911b74cac6bf0bd32495fc8936439b21ba3dd7533c2a327e5eac08aa", "alg": "HMAC_SHA2"}'
location.service.agent  simulator, send encrypted message: plaintext is:
 {'minimumFactorScore': 14, 'currentFactorScore': 13}
user.agent : receiveEncryptedMessage dict:
location.service.agent  simulator, send encrypted raw message:
 {'minimumFactorScore': 14, 'header': {'spir': b'(Y_(vh\n\x05', 'spii': b'h%B\xc3\x8fI\x9av', 'length': 310, 'sender': False, 'counter': 9, 'exchange_type': b'2', 'message_type': False}, 'rawMessage': b'\x00\x00\x016h%B\xc3\x8fI\x9av(Y_(vh\n\x05\x002\x00\x00\x00\x00\x00\t{"msg": "{\\"MODE\\": 2, \\"CipherText\\": \\"MQO3bnDSdLbpKtgbDWw6S6HbG8mSxmvL4syEPNyRKs2f78g8QvWbn0oBbvjycaIwXAKflBBDNkuCurrrOEGKRQ==\\", \\"IV\\": \\"9KNX3UaWlM2N3Bv1Id7s5Q==\\", \\"ALG\\": 0}", "digest": "47a4b910ba598500e2674b15a178dff9432daed353d85ea7ee6cc1faa741c3d6", "alg": "HMAC_SHA2"}', 'currentFactorScore': 13}
 b'\x00\x00\x016h%B\xc3\x8fI\x9av(Y_(vh\n\x05\x002\x00\x00\x00\x00\x00\t{"msg": "{\\"MODE\\": 2, \\"CipherText\\": \\"MQO3bnDSdLbpKtgbDWw6S6HbG8mSxmvL4syEPNyRKs2f78g8QvWbn0oBbvjycaIwXAKflBBDNkuCurrrOEGKRQ==\\", \\"IV\\": \\"9KNX3UaWlM2N3Bv1Id7s5Q==\\", \\"ALG\\": 0}", "digest": "47a4b910ba598500e2674b15a178dff9432daed353d85ea7ee6cc1faa741c3d6", "alg": "HMAC_SHA2"}'
User agent: processing state:  State.TIER2_PRIVACY_AUTHENTICATION_ADDITIONAL_AUTHENTICATION_FACTORS
Location Server: processing state:  State.TIER2_PRIVACY_AUTHENTICATION_ADDITIONAL_AUTHENTICATION_FACTORS
user.agent  simulator, send encrypted message: plaintext is:
 {'enonce': '{"MODE": 2, "CipherText": "M0cv6+AxJpAkguD+iZbjSx+78/EaFCUz76TDMeFDoRMHoW+RkmXKD3iUNbeR5NEP", "IV": "SDvA/jWk5W6iR/SflTlZjA==", "ALG": 0}', 'authenticationKeyType': 'Iris'}
location.service.agent : receiveEncryptedMessage dict:
 {'enonce': '{"MODE": 2, "CipherText": "M0cv6+AxJpAkguD+iZbjSx+78/EaFCUz76TDMeFDoRMHoW+RkmXKD3iUNbeR5NEP", "IV": "SDvA/jWk5W6iR/SflTlZjA==", "ALG": 0}', 'rawMessage': b'\x00\x00\x01\xf6h%B\xc3\x8fI\x9av(Y_(vh\n\x05(2\x00\x00\x00\x00\x00\x08{"msg": "{\\"MODE\\": 2, \\"CipherText\\": \\"j1dJkgBGhn0IZjbE9GTTB8Xyx+1xnvGuvJsBus3j/MvdWCXB2C8s0yzCuwfnfSgI4rFjAl8PXm71mT/h75073FHSkJdJ2ZUH/0+osfMpPYlzpUF7h6VuYKyIuE8hBEAOpMuMympEHgys2mQ+nd6x8YpMJIOsyaHkuUpMpoDHS6bPhOmG0OvN4W9vI8ax0925xjUosVkawkLAayvYFEWtoa7H8IaTZVVK8sZpmHRXCDhEfjPqRgLyM9yi/j6MICE5HdfElbCNgqzLYdaGw987TQ==\\", \\"IV\\": \\"yG4os3eVUUP91Tn4y2N8sw==\\", \\"ALG\\": 0}", "digest": "9c7f9f4f37a438fec3eef46a94ce1910d168bb12a20c4612afe78deb8c8cd141", "alg": "HMAC_SHA2"}', 'header': {'spir': b'(Y_(vh\n\x05', 'spii': b'h%B\xc3\x8fI\x9av', 'length': 502, 'sender': True, 'counter': 8, 'exchange_type': b'2', 'message_type': True}, 'authenticationKeyType': 'Iris'}
user.agent  simulator, send encrypted raw message:
 b'\x00\x00\x01\xf6h%B\xc3\x8fI\x9av(Y_(vh\n\x05(2\x00\x00\x00\x00\x00\x08{"msg": "{\\"MODE\\": 2, \\"CipherText\\": \\"j1dJkgBGhn0IZjbE9GTTB8Xyx+1xnvGuvJsBus3j/MvdWCXB2C8s0yzCuwfnfSgI4rFjAl8PXm71mT/h75073FHSkJdJ2ZUH/0+osfMpPYlzpUF7h6VuYKyIuE8hBEAOpMuMympEHgys2mQ+nd6x8YpMJIOsyaHkuUpMpoDHS6bPhOmG0OvN4W9vI8ax0925xjUosVkawkLAayvYFEWtoa7H8IaTZVVK8sZpmHRXCDhEfjPqRgLyM9yi/j6MICE5HdfElbCNgqzLYdaGw987TQ==\\", \\"IV\\": \\"yG4os3eVUUP91Tn4y2N8sw==\\", \\"ALG\\": 0}", "digest": "9c7f9f4f37a438fec3eef46a94ce1910d168bb12a20c4612afe78deb8c8cd141", "alg": "HMAC_SHA2"}'
User agent: ENONCE, keyType:
 b'\x00\x00\x01\xf6h%B\xc3\x8fI\x9av(Y_(vh\n\x05(2\x00\x00\x00\x00\x00\x08{"msg": "{\\"MODE\\": 2, \\"CipherText\\": \\"j1dJkgBGhn0IZjbE9GTTB8Xyx+1xnvGuvJsBus3j/MvdWCXB2C8s0yzCuwfnfSgI4rFjAl8PXm71mT/h75073FHSkJdJ2ZUH/0+osfMpPYlzpUF7h6VuYKyIuE8hBEAOpMuMympEHgys2mQ+nd6x8YpMJIOsyaHkuUpMpoDHS6bPhOmG0OvN4W9vI8ax0925xjUosVkawkLAayvYFEWtoa7H8IaTZVVK8sZpmHRXCDhEfjPqRgLyM9yi/j6MICE5HdfElbCNgqzLYdaGw987TQ==\\", \\"IV\\": \\"yG4os3eVUUP91Tn4y2N8sw==\\", \\"ALG\\": 0}", "digest": "9c7f9f4f37a438fec3eef46a94ce1910d168bb12a20c4612afe78deb8c8cd141", "alg": "HMAC_SHA2"}'
location.service.agent  simulator, send encrypted message: plaintext is:
 {'minimumFactorScore': 14, 'currentFactorScore': 16}
user.agent : receiveEncryptedMessage dict:
location.service.agent  simulator, send encrypted raw message:
 {'minimumFactorScore': 14, 'header': {'spir': b'(Y_(vh\n\x05', 'spii': b'h%B\xc3\x8fI\x9av', 'length': 310, 'sender': False, 'counter': 10, 'exchange_type': b'2', 'message_type': False}, 'rawMessage': b'\x00\x00\x016h%B\xc3\x8fI\x9av(Y_(vh\n\x05\x002\x00\x00\x00\x00\x00\n{"msg": "{\\"MODE\\": 2, \\"CipherText\\": \\"ggxE4TJI0gy4AJvaQUSusTCvXJRwrEs4BHutk26/Jed/gl34XTo8MnbTYMxwYIkTUJxkawPSA2tBFoQeAfE92A==\\", \\"IV\\": \\"+Nt7uvRDXCKNfeWJwELfcg==\\", \\"ALG\\": 0}", "digest": "353644a7552411fe515ed4b483537a5b8300b2bd622fed005c3b6798df40450d", "alg": "HMAC_SHA2"}', 'currentFactorScore': 16}
 b'\x00\x00\x016h%B\xc3\x8fI\x9av(Y_(vh\n\x05\x002\x00\x00\x00\x00\x00\n{"msg": "{\\"MODE\\": 2, \\"CipherText\\": \\"ggxE4TJI0gy4AJvaQUSusTCvXJRwrEs4BHutk26/Jed/gl34XTo8MnbTYMxwYIkTUJxkawPSA2tBFoQeAfE92A==\\", \\"IV\\": \\"+Nt7uvRDXCKNfeWJwELfcg==\\", \\"ALG\\": 0}", "digest": "353644a7552411fe515ed4b483537a5b8300b2bd622fed005c3b6798df40450d", "alg": "HMAC_SHA2"}'
User agent: Authenticated!
Location Service: Authenticated!
User agent: processing state:  State.TIER2_PRIVACY_AUTHENTICATION_LPK_LSK
user.agent : LSK:
 99632292960861786490472705930267945833818427349335816890018918067324878471010 
LPK:
Location Server: processing state:  State.TIER2_PRIVACY_AUTHENTICATION_LPK_LSK
 [8213624357954436709608143427048313840227882315239885462635811026739586985592233913744575334073955949406497638276462643420291453182866081434916110058833522, 7656654985855635191060062431539969631715036094696956673440525864267095403311021190454053850923727273936375367402822056806971315879727572288755436396060252]
user.agent  simulator, send encrypted message: plaintext is:
 {'lpki': [8213624357954436709608143427048313840227882315239885462635811026739586985592233913744575334073955949406497638276462643420291453182866081434916110058833522, 7656654985855635191060062431539969631715036094696956673440525864267095403311021190454053850923727273936375367402822056806971315879727572288755436396060252]}
user.agent  simulator, send encrypted raw message:
location.service.agent : receiveEncryptedMessage dict:
 {'rawMessage': b'\x00\x00\x01\xdeh%B\xc3\x8fI\x9av(Y_(vh\n\x05(2\x00\x00\x00\x00\x00\t{"msg": "{\\"MODE\\": 2, \\"CipherText\\": \\"koOEKIlJI1wgEMi52Cxm0RHX7EjqDQdAyp5SdhUnctvm73mJ92QjfHGTyUvb8iRh3BACNPHDJXOQan7yN9VrzpVXGjMZ6KTxDLU47HzbS+AAvGNICViUABn59n7KKlWW91YgGuQoZMaFLZZ8cX/rcmfYu2bdEUCkhVWh4B6x9OIE6esNs52Oj4FZLUf+c/yTHh4gnha9Qrle6iEUe2ySdyVVLwK4bcqZWJj+N+9sYVdoMsdwOPNIZCE61hz4MWnw\\", \\"IV\\": \\"mkWhhNOtfqy41vBpZ8Hr5g==\\", \\"ALG\\": 0}", "digest": "24750b4c578e20234aa803282e6fb047393aec4caa1ee5d6046d64be62e280be", "alg": "HMAC_SHA2"}', 'header': {'spir': b'(Y_(vh\n\x05', 'spii': b'h%B\xc3\x8fI\x9av', 'length': 478, 'sender': True, 'counter': 9, 'exchange_type': b'2', 'message_type': True}, 'lpki': [8213624357954436709608143427048313840227882315239885462635811026739586985592233913744575334073955949406497638276462643420291453182866081434916110058833522, 7656654985855635191060062431539969631715036094696956673440525864267095403311021190454053850923727273936375367402822056806971315879727572288755436396060252]}
 b'\x00\x00\x01\xdeh%B\xc3\x8fI\x9av(Y_(vh\n\x05(2\x00\x00\x00\x00\x00\t{"msg": "{\\"MODE\\": 2, \\"CipherText\\": \\"koOEKIlJI1wgEMi52Cxm0RHX7EjqDQdAyp5SdhUnctvm73mJ92QjfHGTyUvb8iRh3BACNPHDJXOQan7yN9VrzpVXGjMZ6KTxDLU47HzbS+AAvGNICViUABn59n7KKlWW91YgGuQoZMaFLZZ8cX/rcmfYu2bdEUCkhVWh4B6x9OIE6esNs52Oj4FZLUf+c/yTHh4gnha9Qrle6iEUe2ySdyVVLwK4bcqZWJj+N+9sYVdoMsdwOPNIZCE61hz4MWnw\\", \\"IV\\": \\"mkWhhNOtfqy41vBpZ8Hr5g==\\", \\"ALG\\": 0}", "digest": "24750b4c578e20234aa803282e6fb047393aec4caa1ee5d6046d64be62e280be", "alg": "HMAC_SHA2"}'


MitM Attack Mode: Mallory here, impersonating Location Service (Alice). Attempt to deceive Bob into thinking he has obtained full authentication with Alice by using random sAuth....


location.service.agent : LSK:
 17081791573318082154867486317671010356605140597638600757740833935205853435883 
LPK:
 [1248332847828944996297105754234491243453666737813729157646363695919467076783320220297699427375519357567381797157019538846206295802733275577411781483278186, 3538840296960678867469797931178666859074072952335852147716044690168418324355968077777526259986198132425561217307972265704238074697707117733822829116498898]
location.service.agent  simulator, send encrypted message: plaintext is:
 {'lpkr': [1248332847828944996297105754234491243453666737813729157646363695919467076783320220297699427375519357567381797157019538846206295802733275577411781483278186, 3538840296960678867469797931178666859074072952335852147716044690168418324355968077777526259986198132425561217307972265704238074697707117733822829116498898]}
user.agent : receiveEncryptedMessage dict:
location.service.agent  simulator, send encrypted raw message:
 {'lpkr': [1248332847828944996297105754234491243453666737813729157646363695919467076783320220297699427375519357567381797157019538846206295802733275577411781483278186, 3538840296960678867469797931178666859074072952335852147716044690168418324355968077777526259986198132425561217307972265704238074697707117733822829116498898], 'header': {'spir': b'(Y_(vh\n\x05', 'spii': b'h%B\xc3\x8fI\x9av', 'length': 478, 'sender': False, 'counter': 11, 'exchange_type': b'2', 'message_type': False}, 'rawMessage': b'\x00\x00\x01\xdeh%B\xc3\x8fI\x9av(Y_(vh\n\x05\x002\x00\x00\x00\x00\x00\x0b{"msg": "{\\"MODE\\": 2, \\"CipherText\\": \\"0e2uIjQ7EGZbA1CrL61IRMhoekKbU8SvCWe3ZJfe1t9SKHEHAwW7y+CGsJ2pH0cyjdpUka5kJIwYyGaxoxhZVnELk3fsFGI6PXdFMRtnNvj/QWSw7ujTjBar2yySosYo6BOISuFIeVwUbpIWcSTClIcoLxpS6/HW+M3hM+Haxo0SVWO/5QhozWTQGi1WaMOB01SO3moFXjjBQDTCez9cyoYZzfNrV4OK8niSR2TLOiJLdMxvRgnpkEC7ZS6Mw/WY\\", \\"IV\\": \\"Ufm3FPnZyxXSBZ4fwlCqgQ==\\", \\"ALG\\": 0}", "digest": "8fe5b74cacf7514fb63c203e86f78df7db6e0f8a3d6f4ae9ccb73465e1904fcc", "alg": "HMAC_SHA2"}'}
 b'\x00\x00\x01\xdeh%B\xc3\x8fI\x9av(Y_(vh\n\x05\x002\x00\x00\x00\x00\x00\x0b{"msg": "{\\"MODE\\": 2, \\"CipherText\\": \\"0e2uIjQ7EGZbA1CrL61IRMhoekKbU8SvCWe3ZJfe1t9SKHEHAwW7y+CGsJ2pH0cyjdpUka5kJIwYyGaxoxhZVnELk3fsFGI6PXdFMRtnNvj/QWSw7ujTjBar2yySosYo6BOISuFIeVwUbpIWcSTClIcoLxpS6/HW+M3hM+Haxo0SVWO/5QhozWTQGi1WaMOB01SO3moFXjjBQDTCez9cyoYZzfNrV4OK8niSR2TLOiJLdMxvRgnpkEC7ZS6Mw/WY\\", \\"IV\\": \\"Ufm3FPnZyxXSBZ4fwlCqgQ==\\", \\"ALG\\": 0}", "digest": "8fe5b74cacf7514fb63c203e86f78df7db6e0f8a3d6f4ae9ccb73465e1904fcc", "alg": "HMAC_SHA2"}'
User agent: processing state:  State.EXCHANGE_AUTHENTICATION_JOINT_FACTOR_KEY_GENERATION
Location Server: processing state:  State.EXCHANGE_AUTHENTICATION_JOINT_FACTOR_KEY_GENERATION
user.agent  simulator, send encrypted message: plaintext is:
 {'authi': b'\xe9\xdf@\xf0\xc0\xbf\x869{V\x8b\xcf\xcb9\x12kL\xe8\xce"\x9f\xc9\x93\x88,y\x02\xc3?|\xddR'}
user.agent  simulator, send encrypted raw message:
location.service.agent : receiveEncryptedMessage dict:
 b'\x00\x00\x01^h%B\xc3\x8fI\x9av(Y_(vh\n\x05(h\x00\x00\x00\x00\x00\n{"msg": "{\\"MODE\\": 2, \\"CipherText\\": \\"aOwhBvbSSPskPZPOCZ7K1ovAlvV4zfetacRZZ5ycDgN2zgwK9ROOMg8JpVciJpenDs3ZpaHIdf6zXOfltLc/4tKEMLNA8dgi04lRJPY5nlU6ZuOvHXZkUsj3mEpKtKtZ\\", \\"IV\\": \\"DrC3olfTptJruFho/oAxgA==\\", \\"ALG\\": 0}", "digest": "b7a0fd5418fc99aa8681ae28423bfc4d302837e863ec7438e1185eacffeec0d6", "alg": "HMAC_SHA2"}'
 {'rawMessage': b'\x00\x00\x01^h%B\xc3\x8fI\x9av(Y_(vh\n\x05(h\x00\x00\x00\x00\x00\n{"msg": "{\\"MODE\\": 2, \\"CipherText\\": \\"aOwhBvbSSPskPZPOCZ7K1ovAlvV4zfetacRZZ5ycDgN2zgwK9ROOMg8JpVciJpenDs3ZpaHIdf6zXOfltLc/4tKEMLNA8dgi04lRJPY5nlU6ZuOvHXZkUsj3mEpKtKtZ\\", \\"IV\\": \\"DrC3olfTptJruFho/oAxgA==\\", \\"ALG\\": 0}", "digest": "b7a0fd5418fc99aa8681ae28423bfc4d302837e863ec7438e1185eacffeec0d6", "alg": "HMAC_SHA2"}', 'header': {'spir': b'(Y_(vh\n\x05', 'spii': b'h%B\xc3\x8fI\x9av', 'length': 350, 'sender': True, 'counter': 10, 'exchange_type': b'h', 'message_type': True}, 'authi': b'\xe9\xdf@\xf0\xc0\xbf\x869{V\x8b\xcf\xcb9\x12kL\xe8\xce"\x9f\xc9\x93\x88,y\x02\xc3?|\xddR'}
Location Server: AUTHi values differ.


MitM Attack Mode: Mallory disregards the mismatching AUTHi send by Bob. Now send AUTHr...


location.service.agent  simulator, send encrypted message: plaintext is:
 {'authr': b'\xe0\x813?\xb6\x91\xeb(\x01I\x94a{\xd7U\xa2\x99\x8c\x19\xbe\xe7\xe7!\x19\xc5f\x84\x0f7\x80\xee\xa4'}
user.agent : receiveEncryptedMessage dict:
location.service.agent  simulator, send encrypted raw message:
 b'\x00\x00\x01^h%B\xc3\x8fI\x9av(Y_(vh\n\x05\x00h\x00\x00\x00\x00\x00\x0c{"msg": "{\\"MODE\\": 2, \\"CipherText\\": \\"c9Dpgf5pDstNfd+As7aboPvDvUZc04Rxve/c1rcMrG5sEOL3K5tKKmjHXdNRyx44DMvBwv2APFwi4uAfgWqWnyksCWJcqucVkxdMkBuGh5ZD1MqncvejtkTmtpbMTEUC\\", \\"IV\\": \\"Jzgi2d7KgyMfYdfLoqLySQ==\\", \\"ALG\\": 0}", "digest": "5ade28b8e9657f84f8942f16a0a6dbca590180189a8b074ad390aff63af3720d", "alg": "HMAC_SHA2"}'
 {'authr': b'\xe0\x813?\xb6\x91\xeb(\x01I\x94a{\xd7U\xa2\x99\x8c\x19\xbe\xe7\xe7!\x19\xc5f\x84\x0f7\x80\xee\xa4', 'rawMessage': b'\x00\x00\x01^h%B\xc3\x8fI\x9av(Y_(vh\n\x05\x00h\x00\x00\x00\x00\x00\x0c{"msg": "{\\"MODE\\": 2, \\"CipherText\\": \\"c9Dpgf5pDstNfd+As7aboPvDvUZc04Rxve/c1rcMrG5sEOL3K5tKKmjHXdNRyx44DMvBwv2APFwi4uAfgWqWnyksCWJcqucVkxdMkBuGh5ZD1MqncvejtkTmtpbMTEUC\\", \\"IV\\": \\"Jzgi2d7KgyMfYdfLoqLySQ==\\", \\"ALG\\": 0}", "digest": "5ade28b8e9657f84f8942f16a0a6dbca590180189a8b074ad390aff63af3720d", "alg": "HMAC_SHA2"}', 'header': {'spir': b'(Y_(vh\n\x05', 'spii': b'h%B\xc3\x8fI\x9av', 'length': 350, 'sender': False, 'counter': 12, 'exchange_type': b'h', 'message_type': False}}
User agent: AUTHr values differ.
User agent: EXCHANGE_AUTHENTICATION_JOINT_FACTOR_KEY_GENERATION: Invalid header or invalid payload.
User agent: processing state:  State.CLOSE_CONNECTIONS_AND_EXIT
User agent: close connection and exit
user.agent : Active threads before cleaning up:  1
User agent: Simulation finished.
Location Server: EXCHANGE_AUTHENTICATION_JOINT_FACTOR_KEY_GENERATION: Authenticated, JFK registered.
Location Server: processing state:  State.AUTHENTICATED_HANDOFF
Location Server: LOCATHE authentication completed. Handing off to RP service.
Location Server: processing state:  State.CLOSE_CONNECTIONS_AND_EXIT
Location Service: close connection and exit
location.service.agent : Active threads before cleaning up:  2
Location Server: Simulation finished.
Simulation concluded.
