Python 3.5.3 |Anaconda 4.4.0 (64-bit)| (default, Mar  6 2017, 11:58:13)
Type "copyright", "credits" or "license" for more information.

IPython 5.3.0 -- An enhanced Interactive Python.
?         -> Introduction and overview of IPython's features.
%quickref -> Quick reference.
help      -> Python's own help system.
object?   -> Details about 'object', use 'object??' for extra details.

runfile('/home/locksmith/phd/thesis/code/AuthenticationService/authenticationservice/evaluation/mitm_tier1_r_replay/locathesimulator.py', wdir='/home/locksmith/phd/thesis/code/AuthenticationService/authenticationservice/evaluation/mitm_tier1_r_replay')
Simulation starting...
Registering keys of keyType:  Password Hash (KDF)
Registering keys of keyType:  Shared Key
Registering keys of keyType:  Fingerprint
Registering keys of keyType:  PIN
Registering keys of keyType:  Pattern
Registering keys of keyType:  Face
Registering keys of keyType:  Iris
Location Server: runProtocol.
User agent: runProtocol.
Location Server: processing state:  State.START_IDLE
User agent: processing state:  State.START_IDLE
Location Server: processStartIdle.
Location Server: processStartIdle. Reset instance variables.
User agent: processStartIdle.
User agent: processStartIdle. Reset instance variables.
User agent: processing state:  State.CONNECT_TO_SERVICE
location.service.agent : entering BNONCE scheduler...
Location Server: processing state:  State.LISTEN_FOR_CONNECTIONS
User agent: processConnectToService.
location.service.agent : BNONCE expired. Generating a new one...
Location Server: processListenForConnections.
self.agentObject =  <locationservice.LocationService object at 0x7fbc5c9d3160>
Exception in connecting to Location Service:  [Errno 111] Connection refused
Attempt# 1
location.service.agent : the Nb is:  b'8ETuOzUNJxCyoekZ6Tz+9A=='
User agent: connected to Location Service.
Location Server: connection request received and accepted.
Location Server: CONNECTION_REQUEST_ACCEPTED_CONNECTED.
User agent: CONNECTED to Location Service.
Location Server: processing state:  State.BROADCAST_ECDHE_ADVERTISEMENT_BLUETOOTH_LOCAUTH_ADVERTISEMENT
User agent: processing state:  State.BROADCAST_ECDHE_ADVERTISEMENT_BLUETOOTH_LOCAUTH_ADVERTISEMENT
Location Server: processBroadcastEcdheAdvertisementBluetoothLocauthAdvertisement.
User agent: processBroadcastEcdheAdvertisementBluetoothLocauthAdvertisement.
Location Server: about to send message at processBroadcastEcdheAdvertisementBluetoothLocauthAdvertisement.
User agent: received proper Location Service advertisement. Setting SPIr.
location.service.agent  simulator, send raw message:
User agent: SERVICE_ADVERTISEMENT_DETECTED.
 b'\x00\x00\x00j\x00\x00\x00\x00\x00\x00\x00\x00\xb4\xdb\x1c\x99\x07\x18\xa4\xf2\x00a\x00\x00\x00\x00\x00\x00{"uuid": "10caa7h0-5e12-71ce-010c-a7hebeac0140", "service": "LOCAUTH Service"}'
Location Server: finished Bluetooth service advertising.
User agent: processing state:  State.BROADCAST_ECDHE_RECEIVE_BNONCE
User agent: processBroadcastEcdheReceiveBnonce.
Location Server: processing state:  State.BROADCAST_ECDHE_BROADCAST_BNONCE
Location Server: Broadcast BNONCE.
Location Server: sending BNONCE...
location.service.agent  simulator, send raw message:
 b'\x00\x00\x14\xad\x00\x00\x00\x00\x00\x00\x00\x00\xb4\xdb\x1c\x99\x07\x18\xa4\xf2\x00b\x00\x00\x00\x00\x00\x01{"locationServiceCertificate": "-----BEGIN CERTIFICATE-----\\nMIIEhTCCAu0CAgN4MA0GCSqGSIb3DQEBCwUAMIGHMQswCQYDVQQGEwJVUzERMA8G\\nA1UECAwIRGVsYXdhcmUxDzANBgNVBAcMBk5ld2FyazEbMBkGA1UECgwSUHJpc3Rp\\nbmVUZWNoTG9ja2VyMRswGQYDVQQLDBJQcmlzdGluZVRlY2hMb2NrZXIxGjAYBgNV\\nBAMMEWxvdGhhbC12aXJ0dWFsYm94MB4XDTE3MDYxMzIwMDE0M1oXDTE4MDYxMzIw\\nMDE0M1owgYcxCzAJBgNVBAYTAlVTMREwDwYDVQQIDAhEZWxhd2FyZTEPMA0GA1UE\\nBwwGTmV3YXJrMRswGQYDVQQKDBJQcmlzdGluZVRlY2hMb2NrZXIxGzAZBgNVBAsM\\nElByaXN0aW5lVGVjaExvY2tlcjEaMBgGA1UEAwwRbG90aGFsLXZpcnR1YWxib3gw\\nggGiMA0GCSqGSIb3DQEBAQUAA4IBjwAwggGKAoIBgQDXZ5TswNp0UFPPbalnSqKt\\nG+UgvEa7N65Gs7CFJSYhz/8LtoZNuUaUZXU681vWimqcV8IU5fg8AXiWoTzZsJA+\\nYvKm1Ozr4hfcXVJ03J8T2eV3HmCE8n8obYLB+dbnBIa+yM6FxtnJreJx12q7SEHG\\npG2XlX2npHvbE++69864x18JEk2hG1Xc1TIsmhER4KLj99wiQQhhVlqqvjS44/pZ\\nqY4dVx0LOKVie8aOoPp8jkU4ZT4pAiTiUIE7u+JpuyxB6aFO8cEVFIgRyvWiH/QR\\nCulxRQRVxCfCoT0GUtDcy5bc4s8qoLJJBrq7peLHzyjhvG+3Md9nzsuHPzuvKpyQ\\nrtZ0p11PtSUJ9se6mUaoej9BFXmYgiMWkbZxqLXLWjN3rCiDzVufgkBO7UKPmBzv\\nbD5QmDoQBLGbZFIrvJLKUT07cePYscAH4wxYTurKX3hRenOjuJSthFkABUoesRG4\\nF/HyN6g0iST6seNtjsA9UZEeMtO38TWWJ90idyW+lw8CAwEAATANBgkqhkiG9w0B\\nAQsFAAOCAYEAb4vr2CknyMtT7XFvVq32adLn4biU2lR8JPrEsWsmjRA37EL33AON\\n8EInUPHTm2TdeNXazEyxPjJPi4CVfx/tOoENKM5ine1P2+7nDtMI/P1CsJQvPKpc\\nazZdF7i6I4+1vIDfx1c+gp03U4fCCwNpt2fAda5u4IoLp8GVGQxBihXM62CvY3rz\\nFGVWljhrpePIWrTRR+5Y00IlYmTUGGE3P+mOyE3G0kf79rOKNh7eKdvvBWe1jJdC\\nrcNfru0VAlhwD0cJnWf5+CvKfzJU12OjxPQiu74Lx0+EAU7wwsekvM9XdUJetar2\\n/I/XO4oMoIDO51THMVbom+kMpfi3Hx5Lb0LzFYPjOJGgs+AOWXlj+ajmwT/D4H7n\\nxrljb88TO9brCx2dKUJ8Na2U4eRFPXB+Zdiux8HBwskWRQNRcFuTrIAcpYsBmEIv\\npCExcSrn/5RNniw/d09a4vbBH8YUlhU7RnGH6cfq0wUDA0GeuyHiltRMDBbSXUHx\\nJ/QsK3Jyxu5o\\n-----END CERTIFICATE-----\\n", "bnonce": "{\\"c2\\": {\\"digest\\": \\"821bfdb858cf51d39d0b72beaa8f0a1b7654ca1ae91b6b52c233093041ef57a6\\", \\"alg\\": \\"HMAC_SHA2\\", \\"msg\\": \\"{\\\\\\"CipherText\\\\\\": \\\\\\"JrKMn/DgwkX+x9pkK2tqEkN8B1f7T7x8mafrr68BK0M=\\\\\\", \\\\\\"MODE\\\\\\": 2, \\\\\\"ALG\\\\\\": 0, \\\\\\"IV\\\\\\": \\\\\\"jhZmAtm0szm/uGPF4mWjeA==\\\\\\"}\\"}, \\"c1\\": {\\"C3\\": {\\"GLOBAL.PAYMENT.VISA\\": {\\"__class__\\": \\"pairing.Element\\", \\"__value__\\": \\"1:Xdulv1DFiTlc6SNUhH9+EYtHInRDyZjigq58AH5STPo9Zpx71WjK2OvAyEW83PySmKn6ZzQdBuDib3sd/fqKeAE=\\", \\"__pairingCurve__\\": \\"SS512\\"}, \\"MONCALAMARIEXPEDIA.COM.SPENDINGLIMIT.LEVEL2\\": {\\"__class__\\": \\"pairing.Element\\", \\"__value__\\": \\"1:SsNlKPeGn13SqwjsQo9qdfixF9DuR9uu3cKud/itUNEEeswZlUHrQs/Jv1pDflOkLOhiPKBogkuNGwEyLMr0RgE=\\", \\"__pairingCurve__\\": \\"SS512\\"}, \\"MONCALAMARIEXPEDIA.COM.SPENDINGLIMIT.LEVEL3\\": {\\"__class__\\": \\"pairing.Element\\", \\"__value__\\": \\"1:SC35ZizCX8dsSAZpmtAIVvgh5tqMtaSebIrKShqyYGQKUIEiI/8aoHhGD3JaEU0LwdS/qmvvdO7a7vLPjf1/RwA=\\", \\"__pairingCurve__\\": \\"SS512\\"}}, \\"policy\\": \\"(moncalamariexpedia.com.spendinglimit.level2 OR moncalamariexpedia.com.spendinglimit.level3) AND global.payment.visa\\", \\"C2\\": {\\"GLOBAL.PAYMENT.VISA\\": {\\"__class__\\": \\"pairing.Element\\", \\"__value__\\": \\"1:Z1GKS6QZnEQQM+svjFTOqcVxh8fRHf7y+zX1Xt0C/AJ7kaBdN84f2/4n4iqDgmXcX8pmoMNwo179BF0YCGGoyAA=\\", \\"__pairingCurve__\\": \\"SS512\\"}, \\"MONCALAMARIEXPEDIA.COM.SPENDINGLIMIT.LEVEL2\\": {\\"__class__\\": \\"pairing.Element\\", \\"__value__\\": \\"1:RT31XQoIwlKS7gRMT/Mktq2I7Fp2fvM0EwSmHECWfPDsMKBOVqNufd5yz+NsI1pECB2G3w9pOGseCf/pfrTI3wE=\\", \\"__pairingCurve__\\": \\"SS512\\"}, \\"MONCALAMARIEXPEDIA.COM.SPENDINGLIMIT.LEVEL3\\": {\\"__class__\\": \\"pairing.Element\\", \\"__value__\\": \\"1:eiOxPBPlSJ2egq8sFRlfsdPNf9uJxRqZI2vVouw+WKG0QHO/5KLD3ziG6+ZZ5EdwI1cil3MalJMTuGfFyQc9UwA=\\", \\"__pairingCurve__\\": \\"SS512\\"}}, \\"C1\\": {\\"GLOBAL.PAYMENT.VISA\\": {\\"__class__\\": \\"pairing.Element\\", \\"__value__\\": \\"3:F2MD+pWxwgGFSOcQuua9DsMw8h1mdXvzedC98bI0YO7l23kxh3r7bq6BhGBB7DBaoKYK5++003wXTc0WbJJqQhZ9qKRzom0saVaLyZOLt6K4qunPYuvb6a3Bhx2cFgXaBrVBCi1h61VPwJTgQFCWMLG8pkt1kdaF0p36/57iR5g=\\", \\"__pairingCurve__\\": \\"SS512\\"}, \\"MONCALAMARIEXPEDIA.COM.SPENDINGLIMIT.LEVEL2\\": {\\"__class__\\": \\"pairing.Element\\", \\"__value__\\": \\"3:nD3Bf8lATfPNqstqRagAj6H3282xupmQ78HlJJrDo80U2TBrr9XdAE+r+1Hq98PpPGjD5Jk4wBm8KCL7mfwwnivgmba2rCriO2RU/7Q8KNip9RFrmKkprNsmwYu2YXYjVOkzPSpwjU47ZiLjrDxbvTkitFJ6lq18mXFb89Oj2f8=\\", \\"__pairingCurve__\\": \\"SS512\\"}, \\"MONCALAMARIEXPEDIA.COM.SPENDINGLIMIT.LEVEL3\\": {\\"__class__\\": \\"pairing.Element\\", \\"__value__\\": \\"3:I1+rfv+9FHeLunezEtJ6CzlbPl365QWbBR05BlSAZd2Iry9Y5T/xiiDu+7Y/0e4gJY1COvJLRndVq5dALlVPF4hrdY57y5DADlw24jCwKhFj+HW42c0KUhW9Oq6pgzAT9/8pKCgm1KG5oDmKpYZkZOUTjYkMSeS0v1wZeZ8Pg3I=\\", \\"__pairingCurve__\\": \\"SS512\\"}}, \\"C0\\": {\\"__class__\\": \\"pairing.Element\\", \\"__value__\\": \\"3:WjRTyIM1FbenqfUCPFkR0EI/pLIU5R4JD5VouD/o+i2oOAidUvdLGqwZ3HjqRwpoTFgBjUrZ1UrY1prp1ocFfIl9NFOE/6zrh6NgAs794lTP+4PjNkr6CxjQrPQ554B7sKTiWV11CaHK/t6SE0UePgddZBMEGLFLJ4YeZgRxQ2s=\\", \\"__pairingCurve__\\": \\"SS512\\"}}}", "bnonceSignature": {"__class__": "bytes", "__value__": "OiKnWMjxKUJq4SRgYtVC94jPF6+vYLRcaewgv9tNeNAAwrnHme24pMAAkmljRPMxddGfmDVky4JK+4nJym2PEJLxLmwEA33kXjGGnq9FLzSB//D9NdPuUVoA1lKNXz3VKTp1MgHmJc8YLo+N6hhNWWUPJdGmMevZ8nzBTL1/1SE68e50nN/rsIQR8NR8rh3Eo3LfnILWzO2nSwdM+WF3GKo/nnhhr025EmS+Tm1qIjaTa3wDtBUZQCrqYwt553xmHK4kGVVzj9kawrpePuHOUEjh3rZiiq31HF15wiSM6mQ8PvEDFbr6aKKyDG603nrNQPjXGXH8kHIqv/D8Q84RZobmrNperyOpdxQJEmhtmI+eb2yYgfy3qolTrN+ucCjEhT2FWqHvoioOuw5xjhZfewVPADfrAE9m2YYKqLRljzb1GWOp0zgmXy87VY5fBScLlX+QMmjR+cai/GLgGKXbveexb+LVCD31ZdzGw6st1aLzGGyEdU8F0XOJX47LFQM9"}}'
Location Server: waiting for KEi, Ni.
User agent: received BNONCE payload. Now verify signature and attempt decrypting...
User agent: BNONCE signature is valid.
User agent: BNONCE to decrypt is:
 {'c2': {'digest': '821bfdb858cf51d39d0b72beaa8f0a1b7654ca1ae91b6b52c233093041ef57a6', 'alg': 'HMAC_SHA2', 'msg': '{"CipherText": "JrKMn/DgwkX+x9pkK2tqEkN8B1f7T7x8mafrr68BK0M=", "MODE": 2, "ALG": 0, "IV": "jhZmAtm0szm/uGPF4mWjeA=="}'}, 'c1': {'C3': {'GLOBAL.PAYMENT.VISA': [4915742218392731875866069301349660328983423231837177271391151154377267110304728975038951381402239557995577057093547359571455028851747923178506621298575992, 1613260120685858952441859422019556914895670619863011402235294684878999983990806972414882955924456039758391804921437199753055618596042963190805414789966441], 'MONCALAMARIEXPEDIA.COM.SPENDINGLIMIT.LEVEL2': [3915669771601637387105887253033807472508406645849785756657077608359375061187994527886300741867755089131504420533434779507060701844512101843769590303880262, 6540315438982704764229196738160317297003659702007071836384131482995126852155184462111485242141591267133265213641498906855230385922678636881325795390715597], 'MONCALAMARIEXPEDIA.COM.SPENDINGLIMIT.LEVEL3': [3780351703084816177767562235748674505139333646551465217813697179278289336589154670113030065496159000274239416000882918382148343563851072536942760377024327, 6499243716933198959843125127148876511213539886784354739356927180959497445951833756331956868470329531741605022920419204082940054446653599655947129988974406]}, 'policy': '(moncalamariexpedia.com.spendinglimit.level2 OR moncalamariexpedia.com.spendinglimit.level3) AND global.payment.visa', 'C2': {'GLOBAL.PAYMENT.VISA': [5411229783030332951186044396744362186096488531437117504513135275011586314573696807382065845388649485332811644434898560269715261385649587482560584159963336, 4954299434554819673512660217547673293702580844810668433093461278712189056417706249195668281763842339481837834948085507335639293658258373210042369091901708], 'MONCALAMARIEXPEDIA.COM.SPENDINGLIMIT.LEVEL2': [3626499119323996197098162211932626326729998295053406084313101306055471021263597952597699095259919215751615774592962228673399441584020300377192159398643935, 4306316799404194000417606414018480383732197919322298078483413664553520782703616115833154347401574041586286249221759524231202692188203991113992848273236201], 'MONCALAMARIEXPEDIA.COM.SPENDINGLIMIT.LEVEL3': [6396960648785880674183293566867050398074324400174155466955446885149968717263075322702550556601436949665795297362977627338960986856692836821846173071916371, 3570303494712497573843687423716115904365581056133466331626300659323066273061523328256490116582649779685896080297278863462480472889742562374357619028399020]}, 'C1': {'GLOBAL.PAYMENT.VISA': [1224865027857584353581895261267410260082928840642468461397409790855270447963481006349586964248494554439463244782940960780646843766028954511344130667473474, 1177941631642129808822680849504190097378907282569261182605804652430870810866042045864069852492214262099929254058735805766885777859428087070282290334680984], 'MONCALAMARIEXPEDIA.COM.SPENDINGLIMIT.LEVEL2': [8183017397269937523535913361967278316414111338781150385901168505632602207421888907660771745577247865865372202567417317059894034372474723487135523074224286, 2298043049776115682091276585340564734501258937530257017187111654592977550024259344468580485660302776600279892265500840376511152353961092461803681706400255], 'MONCALAMARIEXPEDIA.COM.SPENDINGLIMIT.LEVEL3': [1852671551279639635995744968725242800796706639179858355579264082887116172164954300688918854676436922127366946949336721984276252790940646590942463414062871, 7144882709882782647770794976827978521593316998751266541789259803278354756287403888253688810183184437050094439098985395170255871972558322997485278514348914]}, 'C0': [4724387951708999845692106504983277295767534424118280581075719560303334629994513502677245152223000574208672578170333067780295471145251139242537550048855420, 7200887394076193537927963310780134558214807750843887050789097738776617616112287786958300526098913993245569230093352033816772940409889826366260477508535147]}}
User agent: BNONCE decryption successful.
User agent: BNONCE_RECEIVED.
User agent: processing state:  State.BROADCAST_ECDHE_SEND_KEI_NI
User agent: processBroadcastEcdheSendKeiNi.
User agent: sending KEi, Ni...
user.agent  simulator, send raw message:
Location Server: received KEi, Ni.
 b'\x00\x00\x01(0\xdf\xfaJ\xa5\x13!\xc4\xb4\xdb\x1c\x99\x07\x18\xa4\xf2(k\x00\x00\x00\x00\x00\x00{"kei": {"__class__": "pairing.Element", "__value__": "1:T3Z5lQG4R+FGP1Re6UWVCO+nF/9nfGmiCVC29v8rABzFGzZfNNNjnV9ZeDmkN8eTp6l/XX+ZSxkWXrLTwsVWaQA=", "__pairingCurve__": "SS512"}, "ni": {"__class__": "bytes", "__value__": "CqJDx8abfyOz8Ik2RRJhS4IB1fVZNTGFlqKCc0AiF94="}}'
Location Server: KEI_NI_RECEIVED, variables set.
User agent: KEi, Ni sent. Waiting for KEr, Nr...
Location Server: processing state:  State.BROADCAST_ECDHE_SEND_KER_NR
Location Server: sending KEr, Nr.
location.service.agent  simulator, send raw message:
 b'\x00\x00\x01(0\xdf\xfaJ\xa5\x13!\xc4\xb4\xdb\x1c\x99\x07\x18\xa4\xf2\x00k\x00\x00\x00\x00\x00\x02{"ker": {"__class__": "pairing.Element", "__value__": "1:V9Qm5vY+8GlQG8cTUS6tBcNSigqU4leOko1PKQnEQQM0eXXba2C2PI9VAmjvnvR292DpVhmX/Dd7FhnHdAz4ygE=", "__pairingCurve__": "SS512"}, "nr": {"__class__": "bytes", "__value__": "tKxn/q2191RMxojdlhxqy1t1qaFeT6cCV62aO7EefE4="}}'
User agent: received KEr, Nr.
Location Server: proceeding to compute shared secrets.
User agent: proceeding to compute shared secrets.
location.service.agent : computeEcdheSecrets.
user.agent : computeEcdheSecrets.
location.service.agent : sharedSecret:  [8538336239572406213989853175723824764918489115065258929856428754669508973814466996112872310323106411779898588249000542346761130281889873743297926144946194, 3244820457302866076100006110134800279906713695506613911639096721230953534908445677467165446087197605917271622608872305526476372956239917071525045996713348]
location.service.agent : keyMaterial:  b'\xe9A\xc2\xff\xa5\xcd\xbd\xc1\x04\xfe\xdb!\xfcu\x0cw\xd6\x14\xe2\xe9u\x1c\xe0\xbb\xc0\x07\xb1k7\xab\x13\x00Mh=mZ_x\xe2\'\x84\xdfF\xb4\xadM\x88O\xe4\xf4\xe3\x92\xee}\xee+\xa6Of\xbfF\x1d\x84\xbb&`)\x1fY\xf7\x05\x1b\xd3\xbbJ\x95\xf2MHd\xdd/\xce; \xbd4-\x99\x92\x83\xa3\t\xc1\xf6,\x8b\xb9,\xb0*Y4\xd8z\x11\xc7b=\xb4(\x03\x9a\x11\xb5>_\x17\x85\xa9+CG\xdd\x00C\x89\xbb\xfe\x08,%\xe9y\x82}q\x02T\x14\xdd\xbe\xe8\xe4\xf89\xe6M!#\xce\x9fcnn\xd2\x89\x96\xc2+\xba\xacECO\xf2?\x0b\xf5\x93!\x0f1Oy\x8c\xe0\xe6\xaaM[\x10\x0f\x11\xc0\xda\x06\xd2\xd0n\x81\x13*\xad\x85\x8b\xed\xfdh<\x9a\x9fu\xfen\xe8\xaaG\x95\x0c\xb3\xdc\x1f\x19p0\xfa\xa5\xa1\xd6~\xeb\x8dTN"i\xbb\x15\xa7\x14WUd\x894>\x91Z\x88\xaf\xeb\x18\x9b\xbene\x9an\xf6\x0bW\x83\xe12'
user.agent : sharedSecret:  [8538336239572406213989853175723824764918489115065258929856428754669508973814466996112872310323106411779898588249000542346761130281889873743297926144946194, 3244820457302866076100006110134800279906713695506613911639096721230953534908445677467165446087197605917271622608872305526476372956239917071525045996713348]
location.service.agent : created shared secrets.
user.agent : keyMaterial:  b'\xe9A\xc2\xff\xa5\xcd\xbd\xc1\x04\xfe\xdb!\xfcu\x0cw\xd6\x14\xe2\xe9u\x1c\xe0\xbb\xc0\x07\xb1k7\xab\x13\x00Mh=mZ_x\xe2\'\x84\xdfF\xb4\xadM\x88O\xe4\xf4\xe3\x92\xee}\xee+\xa6Of\xbfF\x1d\x84\xbb&`)\x1fY\xf7\x05\x1b\xd3\xbbJ\x95\xf2MHd\xdd/\xce; \xbd4-\x99\x92\x83\xa3\t\xc1\xf6,\x8b\xb9,\xb0*Y4\xd8z\x11\xc7b=\xb4(\x03\x9a\x11\xb5>_\x17\x85\xa9+CG\xdd\x00C\x89\xbb\xfe\x08,%\xe9y\x82}q\x02T\x14\xdd\xbe\xe8\xe4\xf89\xe6M!#\xce\x9fcnn\xd2\x89\x96\xc2+\xba\xacECO\xf2?\x0b\xf5\x93!\x0f1Oy\x8c\xe0\xe6\xaaM[\x10\x0f\x11\xc0\xda\x06\xd2\xd0n\x81\x13*\xad\x85\x8b\xed\xfdh<\x9a\x9fu\xfen\xe8\xaaG\x95\x0c\xb3\xdc\x1f\x19p0\xfa\xa5\xa1\xd6~\xeb\x8dTN"i\xbb\x15\xa7\x14WUd\x894>\x91Z\x88\xaf\xeb\x18\x9b\xbene\x9an\xf6\x0bW\x83\xe12'
Location Server: SHARED_SECRETS_COMPUTED.
user.agent : created shared secrets.
User agent: SHARED_SECRETS_COMPUTED.
Location Server: processing state:  State.TIER1_PRIVACY_AUTHENTICATION
Location Server: processTier1PrivacyAuthentication.
Current messageContainer:
 {'signedOctetsKeiNiRawMessage': b'\x00\x00\x01(0\xdf\xfaJ\xa5\x13!\xc4\xb4\xdb\x1c\x99\x07\x18\xa4\xf2(k\x00\x00\x00\x00\x00\x00{"kei": {"__class__": "pairing.Element", "__value__": "1:T3Z5lQG4R+FGP1Re6UWVCO+nF/9nfGmiCVC29v8rABzFGzZfNNNjnV9ZeDmkN8eTp6l/XX+ZSxkWXrLTwsVWaQA=", "__pairingCurve__": "SS512"}, "ni": {"__class__": "bytes", "__value__": "CqJDx8abfyOz8Ik2RRJhS4IB1fVZNTGFlqKCc0AiF94="}}', 'signedOctetsIdrPayload': b'{"uuid": "10caa7h0-5e12-71ce-010c-a7hebeac0140", "service": "LOCAUTH Service"}', 'signedOctetsKerNrRawMessage': b'\x00\x00\x01(0\xdf\xfaJ\xa5\x13!\xc4\xb4\xdb\x1c\x99\x07\x18\xa4\xf2\x00k\x00\x00\x00\x00\x00\x02{"ker": {"__class__": "pairing.Element", "__value__": "1:V9Qm5vY+8GlQG8cTUS6tBcNSigqU4leOko1PKQnEQQM0eXXba2C2PI9VAmjvnvR292DpVhmX/Dd7FhnHdAz4ygE=", "__pairingCurve__": "SS512"}, "nr": {"__class__": "bytes", "__value__": "tKxn/q2191RMxojdlhxqy1t1qaFeT6cCV62aO7EefE4="}}'}
User agent: processing state:  State.TIER1_PRIVACY_AUTHENTICATION
User agent: processTier1PrivacyAuthentication.
Current messageContainer:
 {'signedOctetsKeiNiRawMessage': b'\x00\x00\x01(0\xdf\xfaJ\xa5\x13!\xc4\xb4\xdb\x1c\x99\x07\x18\xa4\xf2(k\x00\x00\x00\x00\x00\x00{"kei": {"__class__": "pairing.Element", "__value__": "1:T3Z5lQG4R+FGP1Re6UWVCO+nF/9nfGmiCVC29v8rABzFGzZfNNNjnV9ZeDmkN8eTp6l/XX+ZSxkWXrLTwsVWaQA=", "__pairingCurve__": "SS512"}, "ni": {"__class__": "bytes", "__value__": "CqJDx8abfyOz8Ik2RRJhS4IB1fVZNTGFlqKCc0AiF94="}}', 'signedOctetsIdrPayload': b'{"uuid": "10caa7h0-5e12-71ce-010c-a7hebeac0140", "service": "LOCAUTH Service"}', 'signedOctetsKerNrRawMessage': b'\x00\x00\x01(0\xdf\xfaJ\xa5\x13!\xc4\xb4\xdb\x1c\x99\x07\x18\xa4\xf2\x00k\x00\x00\x00\x00\x00\x02{"ker": {"__class__": "pairing.Element", "__value__": "1:V9Qm5vY+8GlQG8cTUS6tBcNSigqU4leOko1PKQnEQQM0eXXba2C2PI9VAmjvnvR292DpVhmX/Dd7FhnHdAz4ygE=", "__pairingCurve__": "SS512"}, "nr": {"__class__": "bytes", "__value__": "tKxn/q2191RMxojdlhxqy1t1qaFeT6cCV62aO7EefE4="}}'}
User agent: authTier1i:  b'\xeeVF\x8f\xda\xe9\xf8\x0etY\xe7A.;\xe7\xcc!}fT\x99\xca\xd3\xe4.\xadSq/\xc1iy' 
Length:  32
user.agent  simulator, send encrypted message: plaintext is:
 {'authTier1i': b'\xeeVF\x8f\xda\xe9\xf8\x0etY\xe7A.;\xe7\xcc!}fT\x99\xca\xd3\xe4.\xadSq/\xc1iy'}
location.service.agent : receiveEncryptedMessage dict:
user.agent  simulator, send encrypted raw message:
 {'rawMessage': b'\x00\x00\x01v0\xdf\xfaJ\xa5\x13!\xc4\xb4\xdb\x1c\x99\x07\x18\xa4\xf2(1\x00\x00\x00\x00\x00\x01{"digest": "c82377721db9ab3040efb08718dd38178b3505f182815e3eaa218faec89326d7", "alg": "HMAC_SHA2", "msg": "{\\"CipherText\\": \\"S5ssatmZyOcTHmlgDkDR0SAUmg3XI2X7IKmFsi6WDhWCs7RPE+EVAJVdBDiY/XV9hHISdn6DRs5QH0enVJPkkcoifbonWrTZ/9yBE3fV23FFDrKvzQ+hqmvNqiY8aWlfY0HpXAHzsHJTCn6ddQTx4A==\\", \\"MODE\\": 2, \\"ALG\\": 0, \\"IV\\": \\"6YCfAzOHQ4PXc+03xzHl5A==\\"}"}', 'authTier1i': b'\xeeVF\x8f\xda\xe9\xf8\x0etY\xe7A.;\xe7\xcc!}fT\x99\xca\xd3\xe4.\xadSq/\xc1iy', 'header': {'counter': 1, 'message_type': True, 'exchange_type': b'1', 'sender': True, 'spii': b'0\xdf\xfaJ\xa5\x13!\xc4', 'length': 374, 'spir': b'\xb4\xdb\x1c\x99\x07\x18\xa4\xf2'}}
 b'\x00\x00\x01v0\xdf\xfaJ\xa5\x13!\xc4\xb4\xdb\x1c\x99\x07\x18\xa4\xf2(1\x00\x00\x00\x00\x00\x01{"digest": "c82377721db9ab3040efb08718dd38178b3505f182815e3eaa218faec89326d7", "alg": "HMAC_SHA2", "msg": "{\\"CipherText\\": \\"S5ssatmZyOcTHmlgDkDR0SAUmg3XI2X7IKmFsi6WDhWCs7RPE+EVAJVdBDiY/XV9hHISdn6DRs5QH0enVJPkkcoifbonWrTZ/9yBE3fV23FFDrKvzQ+hqmvNqiY8aWlfY0HpXAHzsHJTCn6ddQTx4A==\\", \\"MODE\\": 2, \\"ALG\\": 0, \\"IV\\": \\"6YCfAzOHQ4PXc+03xzHl5A==\\"}"}'
Location Server: authTier1i:  b'\xeeVF\x8f\xda\xe9\xf8\x0etY\xe7A.;\xe7\xcc!}fT\x99\xca\xd3\xe4.\xadSq/\xc1iy' 
Length: User agent: AUTH_TIER1i sent:
 32
 b'\x00\x00\x01v0\xdf\xfaJ\xa5\x13!\xc4\xb4\xdb\x1c\x99\x07\x18\xa4\xf2(1\x00\x00\x00\x00\x00\x01{"digest": "c82377721db9ab3040efb08718dd38178b3505f182815e3eaa218faec89326d7", "alg": "HMAC_SHA2", "msg": "{\\"CipherText\\": \\"S5ssatmZyOcTHmlgDkDR0SAUmg3XI2X7IKmFsi6WDhWCs7RPE+EVAJVdBDiY/XV9hHISdn6DRs5QH0enVJPkkcoifbonWrTZ/9yBE3fV23FFDrKvzQ+hqmvNqiY8aWlfY0HpXAHzsHJTCn6ddQTx4A==\\", \\"MODE\\": 2, \\"ALG\\": 0, \\"IV\\": \\"6YCfAzOHQ4PXc+03xzHl5A==\\"}"}'
Location Server: authTier1iLocal type:  <class 'bytes'> b'\xeeVF\x8f\xda\xe9\xf8\x0etY\xe7A.;\xe7\xcc!}fT\x99\xca\xd3\xe4.\xadSq/\xc1iy'
Location Server: authTier1iReceived type:  <class 'bytes'> b'\xeeVF\x8f\xda\xe9\xf8\x0etY\xe7A.;\xe7\xcc!}fT\x99\xca\xd3\xe4.\xadSq/\xc1iy'


MitM Attack Mode: Mallory here, impersonating Location Service (Alice). Attempting to replay AUTH_TIER1_r...


location.service.agent  simulator, send encrypted message: plaintext is:
 {'authTier1rSignature': b"b\x0f&?W\xfd\x1dTf\xbbt\n\xb52\xd5\x01\x94\xfb\xae\xf8\x15\xae\\?.v\xefWf\xfb\xe38\x1a \xbc\x1d5/-Ic\x10p\xc4\xba\x82\xfdp\xb26\x90D\x08\x83\x9c\xaeV\xd5\xf5\xc5\x7f\x8c\x85\r5\x89e\x86\xa1DH\r\xdf$\\\x00\xac\x8dA\xc1\x92\x9c\xd0\xfcS@\x12\xaa\xae\x04\x17aL\xb0\xa0<\t;\x16C\xe4\xf8\x1a\x11\xb4\x04\r\x93\xac \xa5n\xc8\x1b\xa3\x9a\xa2\x18\x85\xba\xb8j@M\x88\x89\xec*\x9a\xf7!\xb7b=\xb5\x87\xbc9++\x06\x05\xac\xb3\xd4b\xa5`\r\xa9.\x12l\xaa\xc7OS\xf2\xf2X^N\x03\x04\xc6c`\xaa\xb5\xc2!TG\xad\xb5h\xd43\xb7fO\xe0\xce\xa9\xa9\x89>\xa4UrsX\x99\x05\xf7\xe7\xa3\xf3\xdf<\xa2\x99+\xad\xc9\x1d\xc3{Q\x84\xd4DUm\xb4\xe0\xacY\xfam\xeb\xf2)\xbc\x98\x9b\xcc\xb3/nd\xdf\xdbu\x02\xb1\xf1\xcdm\xce\xd3b\xf0\xcb\ne\x9c\n\xf8\xb8\xc9\xfa\xa6x\xa5\x9d\xc9\xf3\x02%'D\xda\xb2\xeba@\x9d\\t\xfd\x7f\xa3Q\xb95x\xdd:\x1c\xd3*\xb4oJ\xfe\xfc$K\x01\xed\xf75\xd2\x1f\x89\xb8\x16\x90*\x91\xf7\x9d\xd8f\xdd0\xe9\x157\xf6\r\xe0y\x85=>8\xad\xba>1>\xd0\x0b\x01\x16\xf5@\\T\xe2\x90V\xdd\xd4'\xa3\xcc!\xa8Q>U\x9b3s2\xda\x0fd\xbcD\x01\x1f\xd4&x\x02\xd5\xa3\x1f\xce\xcb\x99\xbb\xb4\xb7Y\xc5\x9d\xb8\xa7L\x17\x1d\xe9f\xb3;5B\x16&", 'idr': {'uuid': '10caa7h0-5e12-71ce-010c-a7hebeac0140', 'service': 'LOCAUTH Service'}, 'locationServiceCertificate': '-----BEGIN CERTIFICATE-----\nMIIEhTCCAu0CAgN4MA0GCSqGSIb3DQEBCwUAMIGHMQswCQYDVQQGEwJVUzERMA8G\nA1UECAwIRGVsYXdhcmUxDzANBgNVBAcMBk5ld2FyazEbMBkGA1UECgwSUHJpc3Rp\nbmVUZWNoTG9ja2VyMRswGQYDVQQLDBJQcmlzdGluZVRlY2hMb2NrZXIxGjAYBgNV\nBAMMEWxvdGhhbC12aXJ0dWFsYm94MB4XDTE3MDYxMzIwMDE0M1oXDTE4MDYxMzIw\nMDE0M1owgYcxCzAJBgNVBAYTAlVTMREwDwYDVQQIDAhEZWxhd2FyZTEPMA0GA1UE\nBwwGTmV3YXJrMRswGQYDVQQKDBJQcmlzdGluZVRlY2hMb2NrZXIxGzAZBgNVBAsM\nElByaXN0aW5lVGVjaExvY2tlcjEaMBgGA1UEAwwRbG90aGFsLXZpcnR1YWxib3gw\nggGiMA0GCSqGSIb3DQEBAQUAA4IBjwAwggGKAoIBgQDXZ5TswNp0UFPPbalnSqKt\nG+UgvEa7N65Gs7CFJSYhz/8LtoZNuUaUZXU681vWimqcV8IU5fg8AXiWoTzZsJA+\nYvKm1Ozr4hfcXVJ03J8T2eV3HmCE8n8obYLB+dbnBIa+yM6FxtnJreJx12q7SEHG\npG2XlX2npHvbE++69864x18JEk2hG1Xc1TIsmhER4KLj99wiQQhhVlqqvjS44/pZ\nqY4dVx0LOKVie8aOoPp8jkU4ZT4pAiTiUIE7u+JpuyxB6aFO8cEVFIgRyvWiH/QR\nCulxRQRVxCfCoT0GUtDcy5bc4s8qoLJJBrq7peLHzyjhvG+3Md9nzsuHPzuvKpyQ\nrtZ0p11PtSUJ9se6mUaoej9BFXmYgiMWkbZxqLXLWjN3rCiDzVufgkBO7UKPmBzv\nbD5QmDoQBLGbZFIrvJLKUT07cePYscAH4wxYTurKX3hRenOjuJSthFkABUoesRG4\nF/HyN6g0iST6seNtjsA9UZEeMtO38TWWJ90idyW+lw8CAwEAATANBgkqhkiG9w0B\nAQsFAAOCAYEAb4vr2CknyMtT7XFvVq32adLn4biU2lR8JPrEsWsmjRA37EL33AON\n8EInUPHTm2TdeNXazEyxPjJPi4CVfx/tOoENKM5ine1P2+7nDtMI/P1CsJQvPKpc\nazZdF7i6I4+1vIDfx1c+gp03U4fCCwNpt2fAda5u4IoLp8GVGQxBihXM62CvY3rz\nFGVWljhrpePIWrTRR+5Y00IlYmTUGGE3P+mOyE3G0kf79rOKNh7eKdvvBWe1jJdC\nrcNfru0VAlhwD0cJnWf5+CvKfzJU12OjxPQiu74Lx0+EAU7wwsekvM9XdUJetar2\n/I/XO4oMoIDO51THMVbom+kMpfi3Hx5Lb0LzFYPjOJGgs+AOWXlj+ajmwT/D4H7n\nxrljb88TO9brCx2dKUJ8Na2U4eRFPXB+Zdiux8HBwskWRQNRcFuTrIAcpYsBmEIv\npCExcSrn/5RNniw/d09a4vbBH8YUlhU7RnGH6cfq0wUDA0GeuyHiltRMDBbSXUHx\nJ/QsK3Jyxu5o\n-----END CERTIFICATE-----\n', 'authTier1r': b'-O\x82t\xb4\xb2\x1a\xcdv]]G\xae\xa8\xf9\x8f\xb4\xb2\xbc\xd5}\xeaeG\xda\xd5a\xc0i\xd4Y\x88'}
location.service.agent  simulator, send encrypted raw message:
user.agent : receiveEncryptedMessage dict:
 {'authTier1rSignature': b"b\x0f&?W\xfd\x1dTf\xbbt\n\xb52\xd5\x01\x94\xfb\xae\xf8\x15\xae\\?.v\xefWf\xfb\xe38\x1a \xbc\x1d5/-Ic\x10p\xc4\xba\x82\xfdp\xb26\x90D\x08\x83\x9c\xaeV\xd5\xf5\xc5\x7f\x8c\x85\r5\x89e\x86\xa1DH\r\xdf$\\\x00\xac\x8dA\xc1\x92\x9c\xd0\xfcS@\x12\xaa\xae\x04\x17aL\xb0\xa0<\t;\x16C\xe4\xf8\x1a\x11\xb4\x04\r\x93\xac \xa5n\xc8\x1b\xa3\x9a\xa2\x18\x85\xba\xb8j@M\x88\x89\xec*\x9a\xf7!\xb7b=\xb5\x87\xbc9++\x06\x05\xac\xb3\xd4b\xa5`\r\xa9.\x12l\xaa\xc7OS\xf2\xf2X^N\x03\x04\xc6c`\xaa\xb5\xc2!TG\xad\xb5h\xd43\xb7fO\xe0\xce\xa9\xa9\x89>\xa4UrsX\x99\x05\xf7\xe7\xa3\xf3\xdf<\xa2\x99+\xad\xc9\x1d\xc3{Q\x84\xd4DUm\xb4\xe0\xacY\xfam\xeb\xf2)\xbc\x98\x9b\xcc\xb3/nd\xdf\xdbu\x02\xb1\xf1\xcdm\xce\xd3b\xf0\xcb\ne\x9c\n\xf8\xb8\xc9\xfa\xa6x\xa5\x9d\xc9\xf3\x02%'D\xda\xb2\xeba@\x9d\\t\xfd\x7f\xa3Q\xb95x\xdd:\x1c\xd3*\xb4oJ\xfe\xfc$K\x01\xed\xf75\xd2\x1f\x89\xb8\x16\x90*\x91\xf7\x9d\xd8f\xdd0\xe9\x157\xf6\r\xe0y\x85=>8\xad\xba>1>\xd0\x0b\x01\x16\xf5@\\T\xe2\x90V\xdd\xd4'\xa3\xcc!\xa8Q>U\x9b3s2\xda\x0fd\xbcD\x01\x1f\xd4&x\x02\xd5\xa3\x1f\xce\xcb\x99\xbb\xb4\xb7Y\xc5\x9d\xb8\xa7L\x17\x1d\xe9f\xb3;5B\x16&", 'rawMessage': b'\x00\x00\r\xb60\xdf\xfaJ\xa5\x13!\xc4\xb4\xdb\x1c\x99\x07\x18\xa4\xf2\x001\x00\x00\x00\x00\x00\x03{"digest": "bd42a96f715669a39b1adcc9cd30d5436c37812f0f8dc66353a1199e7ab38547", "alg": "HMAC_SHA2", "msg": "{\\"CipherText\\": \\"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\\", \\"MODE\\": 2, \\"ALG\\": 0, \\"IV\\": \\"X9trpbhMgrzcSSaw/4v6Lw==\\"}"}', 'locationServiceCertificate': '-----BEGIN CERTIFICATE-----\nMIIEhTCCAu0CAgN4MA0GCSqGSIb3DQEBCwUAMIGHMQswCQYDVQQGEwJVUzERMA8G\nA1UECAwIRGVsYXdhcmUxDzANBgNVBAcMBk5ld2FyazEbMBkGA1UECgwSUHJpc3Rp\nbmVUZWNoTG9ja2VyMRswGQYDVQQLDBJQcmlzdGluZVRlY2hMb2NrZXIxGjAYBgNV\nBAMMEWxvdGhhbC12aXJ0dWFsYm94MB4XDTE3MDYxMzIwMDE0M1oXDTE4MDYxMzIw\nMDE0M1owgYcxCzAJBgNVBAYTAlVTMREwDwYDVQQIDAhEZWxhd2FyZTEPMA0GA1UE\nBwwGTmV3YXJrMRswGQYDVQQKDBJQcmlzdGluZVRlY2hMb2NrZXIxGzAZBgNVBAsM\nElByaXN0aW5lVGVjaExvY2tlcjEaMBgGA1UEAwwRbG90aGFsLXZpcnR1YWxib3gw\nggGiMA0GCSqGSIb3DQEBAQUAA4IBjwAwggGKAoIBgQDXZ5TswNp0UFPPbalnSqKt\nG+UgvEa7N65Gs7CFJSYhz/8LtoZNuUaUZXU681vWimqcV8IU5fg8AXiWoTzZsJA+\nYvKm1Ozr4hfcXVJ03J8T2eV3HmCE8n8obYLB+dbnBIa+yM6FxtnJreJx12q7SEHG\npG2XlX2npHvbE++69864x18JEk2hG1Xc1TIsmhER4KLj99wiQQhhVlqqvjS44/pZ\nqY4dVx0LOKVie8aOoPp8jkU4ZT4pAiTiUIE7u+JpuyxB6aFO8cEVFIgRyvWiH/QR\nCulxRQRVxCfCoT0GUtDcy5bc4s8qoLJJBrq7peLHzyjhvG+3Md9nzsuHPzuvKpyQ\nrtZ0p11PtSUJ9se6mUaoej9BFXmYgiMWkbZxqLXLWjN3rCiDzVufgkBO7UKPmBzv\nbD5QmDoQBLGbZFIrvJLKUT07cePYscAH4wxYTurKX3hRenOjuJSthFkABUoesRG4\nF/HyN6g0iST6seNtjsA9UZEeMtO38TWWJ90idyW+lw8CAwEAATANBgkqhkiG9w0B\nAQsFAAOCAYEAb4vr2CknyMtT7XFvVq32adLn4biU2lR8JPrEsWsmjRA37EL33AON\n8EInUPHTm2TdeNXazEyxPjJPi4CVfx/tOoENKM5ine1P2+7nDtMI/P1CsJQvPKpc\nazZdF7i6I4+1vIDfx1c+gp03U4fCCwNpt2fAda5u4IoLp8GVGQxBihXM62CvY3rz\nFGVWljhrpePIWrTRR+5Y00IlYmTUGGE3P+mOyE3G0kf79rOKNh7eKdvvBWe1jJdC\nrcNfru0VAlhwD0cJnWf5+CvKfzJU12OjxPQiu74Lx0+EAU7wwsekvM9XdUJetar2\n/I/XO4oMoIDO51THMVbom+kMpfi3Hx5Lb0LzFYPjOJGgs+AOWXlj+ajmwT/D4H7n\nxrljb88TO9brCx2dKUJ8Na2U4eRFPXB+Zdiux8HBwskWRQNRcFuTrIAcpYsBmEIv\npCExcSrn/5RNniw/d09a4vbBH8YUlhU7RnGH6cfq0wUDA0GeuyHiltRMDBbSXUHx\nJ/QsK3Jyxu5o\n-----END CERTIFICATE-----\n', 'authTier1r': b'-O\x82t\xb4\xb2\x1a\xcdv]]G\xae\xa8\xf9\x8f\xb4\xb2\xbc\xd5}\xeaeG\xda\xd5a\xc0i\xd4Y\x88', 'header': {'counter': 3, 'message_type': False, 'exchange_type': b'1', 'sender': False, 'spii': b'0\xdf\xfaJ\xa5\x13!\xc4', 'length': 3510, 'spir': b'\xb4\xdb\x1c\x99\x07\x18\xa4\xf2'}, 'idr': {'uuid': '10caa7h0-5e12-71ce-010c-a7hebeac0140', 'service': 'LOCAUTH Service'}}
 b'\x00\x00\r\xb60\xdf\xfaJ\xa5\x13!\xc4\xb4\xdb\x1c\x99\x07\x18\xa4\xf2\x001\x00\x00\x00\x00\x00\x03{"digest": "bd42a96f715669a39b1adcc9cd30d5436c37812f0f8dc66353a1199e7ab38547", "alg": "HMAC_SHA2", "msg": "{\\"CipherText\\": \\"cGoQdisKF5oV58njjV9PJhSu84359ftoPV6YWvYpG+OuSovvmYarWKmzicxaDvdQn9cQPYoWC+Ah89SgeOTPa0nid607OW21waVqwz2FxbM+Iy1Ysp5nu26kH/LEj1nSMj7dgFGzogjAvsFeGzDcVTV7pdAHd5cJX6J4CMKbmQXwR02fxrWnv6TGSN6Mb0oYw66NiG10MdqHJjBh8JW/ijFFpZ3m9Pb9Jb3A35Ohov52GhWnjbFImo2AUbeltq/W3r264cocdRRsYfQwjPsEOwaVmYubs3WQjlhCbbtY1IYPFeV6ikayVcI58o+vINbgi5edHT+VW6zAWLMGC/X1IzusQaJKbh+AYB1hatqBO9tD7lGkr4ToD5LNciy8X+FrcYE5f7vwkTs0Svg/7+uCk9Lp4sSvvIINLI5ZM4+viRtLn2lVWU23yX0B5nCePau1aFXTA3XD72AMYhnK9Z6hFRsu44PR3CVbBcpk+4QQmBvR9UQUvMjDeBdwB9tJHsYz7YCoQ+wy0aHpxSyFXweOkC+5s5/TRLpGWlvG8TqYm4VBQYdqaw1DhHz7oASjS1/TZRdiEaWHknwcyMH/qxsK0V3D+KBPxODOrf6hJn1xeOD4m/IQAo4hIkjtevO4xlzw3tndtEThItQs4ItpKmrf23LPPvqJ1FHKg5y5uklp6hCOIrszeZa9ul5ly+vd9XCp/JUpsetaS2fAMl0eaJQYuSqki6p5VK8rzPW6s6J2liaIbuFvvcNEuWEY14c/kgsk831w8wAMekLJB6npJ/ZxJVbGAofa/qRXOePMzhrIYVEsnESOaPLI5dkXm1T9ev4s8UqRBc0QDsi3X0sDAIq4Wrf5NgYHs9RZQ6N0dCzzOY9Z8sA2Scvd8DReIQQmDo2Rc08JosuP1EQhvRL8LP21jQ2liWuG8tssIS9DlOEDyCFXlk8h0kNYqoqN6ogCyJjnCnCUBxERe+4Vcjj6MbokOXJvkV3458uIKdiB+1xoSifTUijTIdbLek/u7TQfGasFDpOoEpeMIZyNmygHgno4AB9VDB7SfXLCijYaAMRCxKfIhqYkpYIrG5iTXAOvQmFYTIF4WB5gtHwF9Jo/AqwZ6nDC4S1+kty0X60LpvgG1+cjCvayPk4Y0fqpFUSkzFo7khfcuzIGbcDp0iJCz7UofR876fk0faWVTkKtJFIBINq5M4yeqpLJfVAxe2Nt2OB3QV/gsT+CHFN+eWrCl+mpL2cMINfzN+5mJzU1qFsCOXck201YdoLDt0HJAR/lXlY5dEndIqxOKG2rweTNzFaaei2Ejxt6a8aZMreLpCftKEiPBvYC992hFMC3zfwRnFZ+OR333VSx9fANiAalr03O/NIDFYLI6d1y8JxjkuwydJ3Q1oHKq/XMk01kPF0EeoLpXJGp3bLdpXWIt4RTMiJtB/dUvsMcepoMsXVRscwdB9HAUF5qRAER5jDhnsuE/WCupvYLPYfaxcW+ADPLmg8tzVdcpBwYoOtRlQGUqP/WYj2RgoRUl5Citng+Iq2BoipXR76DxleW968y4cWvsn7CYGYoFpMGjQaxcUJPoOxfuzYTjifpJBA9VMazbfB9lizicz/tkevys3AtFMQwwQedvGR/80wZXOphVnT/nB6sSReLQwHjwauf8C91Jxty+G+E5sfDHB/NXZ+4KeDpvZ1fgpBsfovLM8d8ZLPl2B1/2+VVOptuLhe9gycg3LpOO5YkECeAgftyfTH3AZ5aw1bC6u7YEQCIJxiGAuBB/xoES9dBkemImLt3tBZL/Xillg6RSX5HMhUt7kHoR0/cU4d3DExxu7re4fIdOkCnIdPSZZDX5BEhDEIHY5Qb0o0DygiXHADrwzpSbHo5BzuXpWchVG+9ncMu6VzlrvJcR0TEDSC5yyCX6LUkIF6vLiFveZs69aSTF6arBMpq3fPvkAn0JvAKc3QscjV9f3SYvhfnvcCE6DfNt6To4OOGNT4mGhOf36YQzAR5XuuWrkaDFY18Ey/LFvqTwuhLo+HkRxLz1ahteoYEJzwoV2bf8mF0OjL6buqP2dyxzCNjx4Ol8gJW/giQBrA9aFo22qFxNpUlqhLYAyygHGj5RVLNmvImvRuQbwHVvbMmpsLRUQJWkNMr08MMjnDjkPT4jXrX4hMNwPa0u6ZDXqDmxNpzCGGnqXNaS+WPqLMCf2n/P42EkBIT9BtHl++TVGIaUR5wZ5yYIMwt0/m6u/sovYVsSg7W3eo7HVWGUvSbjUAjL7uwi37/OfBwVuqHdg17jQG6GFZq0KbLQN/GCAsO6IMhcjVVW4Tt3j0MGZqYb9H0ymHqYtRisJC+P/Bbt6LGU6LV4GWxBfQPm5Z+NzQSy1XQPuEfXTBllbs9PCXkbP05VdVWVlujjoosrQRXNlDONb3E9pvKu2wtJyzkBPVatbNt4sgLsaBNQPbJSfhI6dWOxj/b4MTaJYIki77tUDwyUQziNtcYFsg7Rv4SL0Bkh11/CYhqTJrxsUq3TTK/PQcvRXjBiNXVQS3/KsV1QKiJHqO8UqKnxxA4xlDxA0jFM2Q7l8qed7H1vydLu1b1TdwVB+MHRxKazhDpQRufmYHWYvIgVHWssSFBkdrvCaAQ7SpzNGcO/qQAe29HQXCjnWuEBmhAdzxCb3s9JHzTMWKTFzXT8KCYu1sSAbV3Qzq5cnkZKuCJHWh80gYlvaqCAF5bilAQ0q21JFg6Fh1J5lxGC8dSNnzjovHMst6cy571D8sQu++UNr8RVytMV9mfyck65iXlWPQceZ4tObXynZhN76t7i9dXJnVge/SY+qiC+dw6d8iE7GW3J1Yfp8fQPpfiprzxJXQtgwlS9BYMUAcz2eHSiGb4Wi4MnLlGqIlpkMPX8w2uLc7JNgKcRAJXtkG4JHlV/ih0HXtrXkP+Cv3WmQzYQ+YAdprA5p/fGnPWwKYDNmy01sl24FG3uosN56aZPAB9p2nhkKz0y671oSncA0wq4sCH9u9Hz8XtcElAp7x5bXKaKqZSwtDH7uRdiC4fMoTz7tDirFbDAO50dTmyjpG4+YMO3OhqaZDZBEL6Jqy94eSJxL/cunBZ4MjREI5dq9hNb1eidEtpSpw6tNSSC+ALyKTYjIZiJhx6c4upA+zfTdfUXaOZFc3Z3NQHnelLT/uT96JLtpXpX0qHkJ8XfeokNZ0K2LJdP+JPbx9CeF+eg8ngvccQm37lfQk/COmjvwcrffCZo+tArCiMd3DJVbgQ8JN9F7t/0DHygcmHSdcjUdtKS30xwOgMkV6m0zYWYjkNjsm+HA==\\", \\"MODE\\": 2, \\"ALG\\": 0, \\"IV\\": \\"X9trpbhMgrzcSSaw/4v6Lw==\\"}"}'
Location Server: AUTH_TIER1r sent:
User agent: authTier1rLocal (expected):
 b'\x00\x00\r\xb60\xdf\xfaJ\xa5\x13!\xc4\xb4\xdb\x1c\x99\x07\x18\xa4\xf2\x001\x00\x00\x00\x00\x00\x03{"digest": "bd42a96f715669a39b1adcc9cd30d5436c37812f0f8dc66353a1199e7ab38547", "alg": "HMAC_SHA2", "msg": "{\\"CipherText\\": \\"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\\", \\"MODE\\": 2, \\"ALG\\": 0, \\"IV\\": \\"X9trpbhMgrzcSSaw/4v6Lw==\\"}"}'
 b't\xe8\x1c\x8c\xb1\x17V\xc7\xd8\x95$\x12(\xc5,\xfb\x04_T&\x85?\xb0\x15\xc8\x14\xc9\xa4Zq\x16\xab'
Location Server: processing state:  State.TIER2_PRIVACY_AUTHENTICATION
User agent: authTier1rReceived:
 b'-O\x82t\xb4\xb2\x1a\xcdv]]G\xae\xa8\xf9\x8f\xb4\xb2\xbc\xd5}\xeaeG\xda\xd5a\xc0i\xd4Y\x88'
User agent: valid AUTH_TIER1r signature
User agent: AUTH_TIER1 values differ.
User agent: State.TIER1_PRIVACY_AUTHENTICATION: header or payload error/invalid.
User agent: processing state:  State.CLOSE_CONNECTIONS_AND_EXIT
User agent: close connection and exit
user.agent : Active threads before cleaning up:  1
Location Server: State.TIER2_PRIVACY_AUTHENTICATION: header or payload or user key not found error.
User agent: Simulation finished.
Location Server: processing state:  State.CLOSE_CONNECTIONS_AND_EXIT
Location Service: close connection and exit
location.service.agent : Active threads before cleaning up:  2
Location Server: Simulation finished.
Simulation concluded.
